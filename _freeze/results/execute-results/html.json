{
  "hash": "a88b8235e7105afac7b9ccac9be3b69d",
  "result": {
    "markdown": "# Results\n\nKey variables:\n- Centrality --->  connectivity\n- Accessibility ----> vulnerability-resilience\n\n\n::: {.cell}\n\n:::\n\n\n## Data preparation\n### OSM & ORS data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"PostGIS: Result from the responsive code to import OSM\"}\n# Osmium command\nosmium extract -b -51.2791,-30.1722,-50.9407,-29.8048 sul-240501.osm.pbf -o puerto_alegre_urban_center.osm.pbf\n```\n:::\n\n```{=html}\n\n<iframe width=\"760\" height=\"500\" src=\"/media/map_sampling_example_v0.html\" title = \"Inspect of the components in the graph network \"></iframe>\n```\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"R: Visualizing regular and weighted sampling\"}\n## Crop and Reproject\n## gdalwarp -te -4850853.201784615 -3737074.296348413 -4616291.881935796 -3495378.804761388 GHS_BUILT_V_E2020_GLOBE_R2023A_54009_100_V1_0.tif GHS_BUILT_V_E2020_GLOBE_R2023A_54009_100_V\n## gdalwarp -t_srs \"EPSG:4326\" GHS_BUILT_V_E2020_GLOBE_R2023A_54009_100_V1_0_RioGrandeDoSul.tif GHS_BUILT_V_E2020_GLOBE_R2023A_4326_100_V1_0_RioGrandeDoSul.tif\npal <- mapview::mapviewPalette(\"mapviewTopoColors\")\nghs_build <- stack(\"/home/ricardo/heigit_bookdown/data/GHS_BUILT_V_E2020_GLOBE_R2023A_4326_100_V1_0_RioGrandeDoSul.tif\")\nghs_smod <- stack(\"/home/ricardo/heigit_bookdown/data/GHS_SMOD_E2020_GLOBE_R2023A_4326_1000_V2_0_RioGrandeDoSul.tif\")\nghs_smod_terra <- terra::rast(\"/home/ricardo/heigit_bookdown/data/GHS_SMOD_E2020_GLOBE_R2023A_4326_1000_V2_0_RioGrandeDoSul.tif\")\nregular_sampling <- st_read(\"/home/ricardo/heigit_bookdown/data/random_points_snapped.geojson\")\nregular_sampling_100 <- sample_n(regular_sampling, size = 100)\nweighted_sampling_origin <- st_read(eisenberg_connection,\"weight_sampling_100_origin\")\nweighted_sampling_destination <- st_read(eisenberg_connection,\"weight_sampling_100_destination\")\n\nweighted_sampling_origin$sample <- \"origin\"\nweighted_sampling_destination$sample <- \"destination\"\nweighted_sampling_both <- rbind(weighted_sampling_origin,\n                           weighted_sampling_destination )\n\nweighted_sampling <- weighted_sampling_both |> mutate(sample = as.factor(weighted_sampling$sample))\n\npoi_hospital <- st_read(eisenberg_connection,\"hospital_rs_node_v2\")\nm <- matrix(c(\n     0, 10, NA,   # Values >= 0 and <= 10 become 0\n     10, 13, 1,  # Values > 10 and <= 21 become 1\n     13, 29, 2,  # Values > 21 and <= 29 become 2\n     30, 30, 3   # Values == 30 become 3\n ), ncol = 3, byrow = TRUE)\n## Classify using the correct matrix\nrc2 <- classify(ghs_smod_terra, m, include.lowest=TRUE)\nrc2_factor <- as.factor(rc2)\nlevels(rc2_factor) <- data.frame(\n  ID = 1:3,    # These should match the values in the classification\n  category = c(\"Rural: 10-13\", \"Suburban: 13-29\", \"Urban Center: 30\")\n)\ncategory_colors <- c(\"#008f44\",\"#dedb96\", \"#cc9152\")\nmapview(ghs_build[[1]],\n        layer.name =\"Built-up volume\",\n        col.regions = pal(100),\n        alpha.regions= 0.45,\n        hide=TRUE) +\nmapview(ghs_smod[[1]],\n        layer.name = \"Settlement classification\",\n        col.regions = pal(100),\n        alpha.regions= 0.35,\n        hide=TRUE) +\nmapview(weighted_sampling,\n        layer.name=\"Weighted samples\",\n        zcol=\"sample\",\n        col.regions=c(\"#2D5CA4\",\"#00A3A0\"),\n        hide=TRUE,\n        cex= 3) +\nmapview(regular_sampling_100,\n        color = \"darkgray\",\n        col.regions=\"darkgray\",\n        cex= 3,\n        legend= FALSE,\n        hide=TRUE) +\nmapview(subset(poi_hospital,\n               select=c(\"cd_cnes\",\n                        \"ds_cnes\",\n                        \"id\",\n                        \"geom_hospital\")),\n                layer.name = \"POI - Hospitals\",\n                color= \"darkred\",\n        col.regions=\"#CA2334\",\n               popup=popupTable(poi_hospital, zcol=c(\"cd_cnes\",\"ds_cnes\",\"id\")))\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n\n## RQ1: Centrality analysis\n\n>How does road connectivity change after being impacted by flooding based on\nconnectivity metrics?\n\n### Sum Edge Betweenness\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"R: Visualizing changes of centrality on the network before and after the flooding calculated with pgrouting\"}\n### natural breaks\n#### For pre-event: 1644, 468, 142\ncentrality_pre$centrality_fct <- cut(centrality_pre$centrality,\n                  breaks=c(0,142,468,1644),\n                  labels =c(\"low\",\"medium\",\"high\"),\n                  include.lowest= TRUE,\n                  right =FALSE)\n#### natural breaks:  81, 230, 582\ncentrality_post$centrality_fct <- cut(centrality_post$centrality,\n                  breaks=c(0,81,230,582),\n                  labels =c(\"low\",\"medium\",\"high\"),\n                  include.lowest= TRUE,\n                  right =FALSE)\n### \ncentrality_pre_map <- mapview::mapview(centrality_pre,\n                                       zcol=\"centrality_fct\",\n                                        lwd =\"centrality\",\n                                       layer.name =\"Centrality Pre-Event\",\n              popup=popupTable(centrality_pre, \n                               zcol=c(\"id\",\"centrality\",\"bidirectid\"))) \ncentrality_post_map <- mapview::mapview(centrality_post,\n                                       zcol=\"centrality_fct\",\n                                        lwd = \"centrality\",\n                                       layer.name =\"Centrality Post-Event\",\n              popup=popupTable(centrality_pre, \n                               zcol=c(\"id\",\"centrality\",\"bidirectid\"))) \n\ncentrality_pre_map | centrality_post_map + mapview(flooding,\n          color=\"darkblue\",\n          alpha.regions= 0.5,\n          layer.name=\"Flooding layer\")\n```\n:::\n\n```{=html}\n\n<iframe width=\"760\" height=\"500\" src=\"/media/centrality_map_results.html\" title = \"Sum Edge Betweenness in the Urban Settlement located in Porto Alegre \"></iframe>\n\n```\n\n\nGEoref\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"R: Table of the most central road segments georeferenced\"}\nlibrary(plyr)\n## Categories for pre-flooding or post-flooding\ndf_centrality_pre <- centrality_pre |>\n                      sf::st_drop_geometry() |>\n                      mutate(event = \"pre-flooding\") \ndf_centrality_post <- centrality_post |>\n                        sf::st_drop_geometry() |>\n                    mutate(event = \"post-flooding\")\n\n#### For pre-event: 1644, 468, 142\ndf_centrality_pre$centrality_fct <- cut(df_centrality_pre$centrality,\n                  breaks=c(0,142,468,1644),\n                  labels =c(\"low\",\"medium\",\"high\"),\n                  include.lowest= TRUE,\n                  right =FALSE)\n#### natural perk:  81, 230, 582\ndf_centrality_post$centrality_fct <- cut(df_centrality_post$centrality,\n                  breaks=c(0,81,230,582),\n                  labels =c(\"low\",\"medium\",\"high\"),\n                  include.lowest= TRUE,\n                  right =FALSE)\n## Join both in one dataframe\ndf_centrality_both <- left_join(df_centrality_pre,\n                    df_centrality_post,\n                    by = 'id',\n                    suffix=c(\"_pre\",\"_post\")) |>    dplyr::select(c(\"id\",\"bidirectid_pre\",\"bidirectid_post\",\"centrality_pre\",\"centrality_post\",\"centrality_fct_pre\",\"centrality_fct_post\",\"event_post\",\"event_pre\")) |>\n  mutate(centrality_post = replace_na(centrality_post, 0)) ## Roads covered by the flooding appeared as NA in the post-scenario, replace tha NA value for 0\n\n## Calculate change on centrality after being impacted by flooding \ndf_centrality_both <-  df_centrality_both |>\n            mutate(centrality_diff = centrality_post-centrality_pre)\n### Obtain distribution using quantiles\ndf_centrality_both_quantiles <- quantile(df_centrality_both$centrality_diff, na.rm =TRUE)\n### Filter the worst scenario, most negative values below second quartile\ndf_centrality_negative_outlier <- df_centrality_both |>\n                        filter( centrality_diff <= df_centrality_both_quantiles[2])\n### Join with original data to obtain again geometry\ndf_centrality_negative_outlier_geom <- df_centrality_negative_outlier |>\n                        arrange(centrality_diff) |>\n                        slice(1:1000) |>\n                        left_join(centrality_pre, by = \"id\") |>\n                    mutate(the_geom_centroid = st_centroid(the_geom),\n                           lon = st_coordinates(the_geom_centroid)[,1],\n                           lat = st_coordinates(the_geom_centroid)[,2])\n# Obtain a subset of the 500 observations oredered by lowest values on centrality difference\ndf_centrality_negative_outlier_geom_unique <- df_centrality_negative_outlier_geom |> \n  distinct(centrality_pre, .keep_all = TRUE) \n# Reverse geocoding to obtain the address based on the centroids\ndf_centrality_negative_outlier_distinct_address <-  tidygeocoder::reverse_geocode(df_centrality_negative_outlier_geom_unique, lat=lat, lon=lon, method=\"osm\")\n## Create ID for the found addresses (97)\ndf_centrality_negative_outlier_distinct_address$address_number <- seq(1, 167,1)\n\ndf_centrality_negative_outlier_distinct_address$short_address <- str_extract(df_centrality_negative_outlier_distinct_address$address, \"^[^,]+, [^,]+\") \ndf_centrality_negative_outlier_distinct_address$centrality_diff_perc <- round(((df_centrality_negative_outlier_distinct_address$centrality_post - df_centrality_negative_outlier_distinct_address$centrality_pre) / df_centrality_negative_outlier_distinct_address$centrality_pre *100),2)\n  \n## DT Table\nDT::datatable(subset(df_centrality_negative_outlier_distinct_address, select=c(\"address_number\", \"short_address\",\"centrality_pre\", \"centrality_post\",\"centrality_diff\",\"centrality_diff_perc\",\"id\",\"source\",\"target\",\"the_geom\")), \n              colnames= c(\"ID\",\"Address\",\"Pre-Centrality\", \"Post-Centrality\",\"Diff-Centrality\",\"Diff-Centrality(%)\",\"id_1\",\"source\",\"target\",\"the_geom\"),\n              filter=\"top\",\n              class='compact', rownames=FALSE, escape=FALSE, caption='Data description',\n              extensions=c(\"Buttons\",'RowGroup'),\n              options=list(\n                  order=list(list(5, 'desc'), list(2,'desc')),  # Sort by the first column (index 5)\n                  dom=\"Bfrtip\",\n                  columnDefs = list(list(visible=FALSE, targets= c(6,7,8,9))),\n                  buttons=c(\"copy\", \"csv\", \"pdf\"),\n                  initComplete = JS(\n                      \"function(settings, json) {\",\n                      \"$(this.api().table().header()).css({'background-color': '#d50038', 'color': '#fff'});\",\n                      \"}\")\n              )\n) |> \n      DT::formatStyle(\"centrality_pre\",\n     background=DT::styleColorBar(range(df_centrality_negative_outlier_distinct_address$centrality_pre), '#ee8b8b'),\n                    backgroundSize='98% 88%',\n                    backgroundRepeat='no-repeat',\n                    backgroundPosition='center') \n```\n:::\n\n```{=html}\n\n<iframe width=\"760\" height=\"500\" src=\"/media/centrality_table_results.html\" title = \"Sum Edge Betweenness in the Urban Settlement located in Porto Alegre \"></iframe>\n\n```\n\n::: {.cell warming='false'}\n\n```{.r .cell-code  code-summary=\"R: Histogram of betweenness centrality calculated with pgrouting\"}\nlibrary(plyr)\n# Tidy data and wrangling\ncentrality_post$event <- \"post-flooding\"\ncentrality_pre$event <- \"pre-flooding\"  \ncentrality_both <- rbind(centrality_post[,c(\"id\",\"centrality\",\"event\")] ,\n                                   centrality_pre[,c(\"id\",\"centrality\",\"event\")])\nmu <- plyr::ddply(centrality_both, \"event\", summarise, grp.mean=mean(centrality))\n\n# Create histogram\nggplot(centrality_both, aes(x=centrality, fill=event)) +\n                    geom_histogram(alpha=0.4,) + scale_x_log10() +\n                  labs(title = \"Centrality analysis\",\n                      subtitle= \"Histogram on log10 scale\",\n                      x = \" Betweenness centrality (centrality)\",\n                      y = \"Frequency (count)\") +\n  theme(plot.title=element_text(family =\"bold\", hjust=0.5),\n        plot.subtitle = element_text(colour=\"#626262\", hjust=0.5),\n        legend.position='bottom') +\n    theme_minimal()\n```\n\n::: {.cell-output-display}\n![](results_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell warming='false'}\n\n```{.r .cell-code  code-summary=\"R: Betweenness centrality values grouped by their quantiles calculated with pgrouting \"}\ndf_centrality_pre <- centrality_pre |>\n                        sf::st_drop_geometry() |>\n                        mutate(event = \"pre-flooding\") \ndf_centrality_post <- centrality_post |> \n                          sf::st_drop_geometry() |>\n                              mutate(event = \"post-flooding\")\n##\ndf_centrality_both_barplot <- dplyr::bind_rows(df_centrality_pre,\n                                               df_centrality_post)\n### percentiles\nq <- quantile(df_centrality_both_barplot$centrality)\nq_pre <- quantile(\n  df_centrality_pre[df_centrality_pre$event == 'pre-flooding',]$centrality)\nq_post <- quantile(\n  df_centrality_post[df_centrality_post$event == 'post-flooding',]$centrality)\n### Centrality\ndf_centrality_both_barplot_cat <- na.omit(df_centrality_both_barplot) |> \n  mutate(centrality_cat=as.factor(case_when(\n    centrality <= q_pre[2] ~ \"Q1\",\n    centrality <= q_pre[3] ~ \"Q2\",\n    centrality <= q_pre[4] ~ \"Q3\",\n    centrality >= q_pre[4] ~ \"Q4\",\n    TRUE ~ \"missing\")))  \n## tidy data\nbarplot_event_cat_sum <- df_centrality_both_barplot_cat |> \n                          dplyr::group_by(event, centrality_cat) |>\n                           dplyr::summarise(sum_centrality = sum(centrality))\n#basic plot\n barplot_event_cat_sum |>  \n  ggplot(aes(x=centrality_cat,\n              y=sum_centrality,\n              fill=event)) +\n  geom_col(width=0.5, position=\"dodge\") +\n  labs(title = \"Centrality analysis\",\n       subtitle= \"Barplot grouped by the post and pre event\",\n       x = \" Quantiles\",\n       y = \"Sum of edge betweenness\") +\n  theme(plot.title=element_text(family =\"bold\", hjust=0.5),\n        plot.subtitle = element_text(colour=\"#626262\", hjust=0.5),\n        legend.position='bottom') +\n     theme_minimal()\n```\n\n::: {.cell-output-display}\n![](results_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n\n\n### Closeness\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"R: Visualizing closeness of the healthcare facilities\"}\n# Import he data\n## hospital with closenesss values\nclosseness <-sf::st_read(eisenberg_connection, \n                            layer = \"clossness_hospital_porto\")\nclosseness_df <- closseness |>  arrange(ds_cnes, closeness) |>\n                    mutate(lng= \n                              unlist(map(geom_hospital,1)),\n                           lat=\n                              unlist(map(geom_hospital,2)),\n                           closeness_norm = \n                          (closseness$closeness - min(closseness$closeness)) / (max(closseness$closeness) - min(closseness$closeness)) * 100,\n                          position = rank(-closeness))\n## Create Color palette for visualization\npal <- colorQuantile(palette = \"OrRd\",closseness_df$closeness, n=4 )\n\n## Create leaflet product\n\nicons <- makeAwesomeIcon(\n  icon = 'fa-heartbeat',\n  iconColor = \"#FFFFFF\",\n  markerColor = \"#57142c\",\n  library = \"fa\"\n)\nleaflet(closseness_df) |>\n    addProviderTiles(providers$OpenStreetMap.HOT) |>\n    addCircles(data =closseness_df , radius = ~sqrt(closeness)*10, fillOpacity = .50, color =~pal(closeness)) |>\n  addAwesomeMarkers(data=closseness_df,\n                          icon =icons,\n                          popup= ~paste0(\"<b>Código CNES: </b>\", cd_cnes, \"<br/>\",\n                                   \"<b>Nome: </b>\", ds_cnes, \"<br/>\",\n                                   \"<b> Closeness</b>:\", closeness, \"<br/>\",\n                                   \"<b>Longitude: </b>\", lng, \"<br/>\",\n                                   \"<b>Posição </b>\", position, \"<br/>\"))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"leaflet html-widget html-fill-item\" id=\"htmlwidget-5588729e83c94d808cdb\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-5588729e83c94d808cdb\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addProviderTiles\",\"args\":[\"OpenStreetMap.HOT\",null,null,{\"errorTileUrl\":\"\",\"noWrap\":false,\"detectRetina\":false}]},{\"method\":\"addCircles\",\"args\":[[-30.09757,-30.009986,-30.039221,-30.084683,-29.940535,-30.047191,-30.028825,-30.061433,-30.059575,-30.026562,-29.822993,-30.016762,-30.044897,-29.906482,-29.839313,-30.056013,-29.88663,-30.037009,-30.081734,-30.030225],[-51.251219,-51.15921,-51.20721,-51.188157,-50.994548,-51.211842,-51.206359,-51.149065,-51.229305,-51.208747,-51.165688,-51.159139,-51.217128,-51.198458,-51.161951,-51.172921,-51.165818,-51.209228,-51.02973,-51.222786],[1820.906367719109,1629.417073680032,1439.687466084219,1684.903558070906,1948.871468311854,1429.82516413721,1449.482666333061,1614.280025274425,1592.45094115957,1487.212157024007,2062.595452336691,1621.758305050417,1449.551654822966,1888.464985113571,2107.889940200864,1532.579524853441,1916.141957162882,1422.392350935564,2092.343184088117,1485.05892138999],null,null,{\"interactive\":true,\"className\":\"\",\"stroke\":true,\"color\":[\"#FC8D59\",\"#FC8D59\",\"#FEF0D9\",\"#FC8D59\",\"#D7301F\",\"#FEF0D9\",\"#FEF0D9\",\"#FDCC8A\",\"#FDCC8A\",\"#FDCC8A\",\"#D7301F\",\"#FC8D59\",\"#FEF0D9\",\"#FC8D59\",\"#D7301F\",\"#FDCC8A\",\"#D7301F\",\"#FEF0D9\",\"#D7301F\",\"#FDCC8A\"],\"weight\":5,\"opacity\":0.5,\"fill\":true,\"fillColor\":[\"#FC8D59\",\"#FC8D59\",\"#FEF0D9\",\"#FC8D59\",\"#D7301F\",\"#FEF0D9\",\"#FEF0D9\",\"#FDCC8A\",\"#FDCC8A\",\"#FDCC8A\",\"#D7301F\",\"#FC8D59\",\"#FEF0D9\",\"#FC8D59\",\"#D7301F\",\"#FDCC8A\",\"#D7301F\",\"#FEF0D9\",\"#D7301F\",\"#FDCC8A\"],\"fillOpacity\":0.5},null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null,null]},{\"method\":\"addAwesomeMarkers\",\"args\":[[-30.09757,-30.009986,-30.039221,-30.084683,-29.940535,-30.047191,-30.028825,-30.061433,-30.059575,-30.026562,-29.822993,-30.016762,-30.044897,-29.906482,-29.839313,-30.056013,-29.88663,-30.037009,-30.081734,-30.030225],[-51.251219,-51.15921,-51.20721,-51.188157,-50.994548,-51.211842,-51.206359,-51.149065,-51.229305,-51.208747,-51.165688,-51.159139,-51.217128,-51.198458,-51.161951,-51.172921,-51.165818,-51.209228,-51.02973,-51.222786],{\"icon\":\"fa-heartbeat\",\"markerColor\":\"#57142c\",\"iconColor\":\"#FFFFFF\",\"spin\":false,\"squareMarker\":false,\"iconRotate\":0,\"font\":\"monospace\",\"prefix\":\"fa\"},null,null,{\"interactive\":true,\"draggable\":false,\"keyboard\":true,\"title\":\"\",\"alt\":\"\",\"zIndexOffset\":0,\"opacity\":1,\"riseOnHover\":false,\"riseOffset\":250},[\"<b>Código CNES: <\\/b>2237156<br/><b>Nome: <\\/b>HBMPA<br/><b> Closeness<\\/b>:33157<br/><b>Longitude: <\\/b>-51.251136<br/><b>Posição <\\/b>7<br/>\",\"<b>Código CNES: <\\/b>2265060<br/><b>Nome: <\\/b>HOSPITAL CRISTO REDENTOR SA<br/><b> Closeness<\\/b>:26550<br/><b>Longitude: <\\/b>-51.159402<br/><b>Posição <\\/b>9<br/>\",\"<b>Código CNES: <\\/b>2237601<br/><b>Nome: <\\/b>HOSPITAL DE CLINICAS<br/><b> Closeness<\\/b>:20727<br/><b>Longitude: <\\/b>-51.206436<br/><b>Posição <\\/b>18<br/>\",\"<b>Código CNES: <\\/b>2237598<br/><b>Nome: <\\/b>HOSPITAL DIVINA PROVIDENCIA<br/><b> Closeness<\\/b>:28389<br/><b>Longitude: <\\/b>-51.18811<br/><b>Posição <\\/b>8<br/>\",\"<b>Código CNES: <\\/b>2232049<br/><b>Nome: <\\/b>HOSPITAL DOM JOAO BECKER<br/><b> Closeness<\\/b>:37981<br/><b>Longitude: <\\/b>-50.994036<br/><b>Posição <\\/b>4<br/>\",\"<b>Código CNES: <\\/b>3567664<br/><b>Nome: <\\/b>HOSPITAL ERNESTO DORNELLES<br/><b> Closeness<\\/b>:20444<br/><b>Longitude: <\\/b>-51.211891<br/><b>Posição <\\/b>19<br/>\",\"<b>Código CNES: <\\/b>2265052<br/><b>Nome: <\\/b>HOSPITAL FEMINA SA<br/><b> Closeness<\\/b>:21010<br/><b>Longitude: <\\/b>-51.206837<br/><b>Posição <\\/b>17<br/>\",\"<b>Código CNES: <\\/b>7092571<br/><b>Nome: <\\/b>HOSPITAL INDEPENDENCIA<br/><b> Closeness<\\/b>:26059<br/><b>Longitude: <\\/b>-51.149056<br/><b>Posição <\\/b>11<br/>\",\"<b>Código CNES: <\\/b>3007847<br/><b>Nome: <\\/b>HOSPITAL MAE DE DEUS<br/><b> Closeness<\\/b>:25359<br/><b>Longitude: <\\/b>-51.229103<br/><b>Posição <\\/b>12<br/>\",\"<b>Código CNES: <\\/b>3006522<br/><b>Nome: <\\/b>HOSPITAL MOINHOS DE VENTO<br/><b> Closeness<\\/b>:22118<br/><b>Longitude: <\\/b>-51.209105<br/><b>Posição <\\/b>14<br/>\",\"<b>Código CNES: <\\/b>2232162<br/><b>Nome: <\\/b>HOSPITAL MUNICIPAL GETULIO VARGASSAPUCAIA DO SUL<br/><b> Closeness<\\/b>:42543<br/><b>Longitude: <\\/b>-51.165855<br/><b>Posição <\\/b>3<br/>\",\"<b>Código CNES: <\\/b>2237571<br/><b>Nome: <\\/b>HOSPITAL NOSSA SENHORA DA CONCEICAO SA<br/><b> Closeness<\\/b>:26301<br/><b>Longitude: <\\/b>-51.159043<br/><b>Posição <\\/b>10<br/>\",\"<b>Código CNES: <\\/b>5026253<br/><b>Nome: <\\/b>HOSPITAL PORTO ALEGRE<br/><b> Closeness<\\/b>:21012<br/><b>Longitude: <\\/b>-51.216909<br/><b>Posição <\\/b>16<br/>\",\"<b>Código CNES: <\\/b>3626245<br/><b>Nome: <\\/b>HOSPITAL PRONTO SOCORRO DE CANOAS DEP NELSON MARCHEZAN<br/><b> Closeness<\\/b>:35663<br/><b>Longitude: <\\/b>-51.198125<br/><b>Posição <\\/b>6<br/>\",\"<b>Código CNES: <\\/b>2232030<br/><b>Nome: <\\/b>HOSPITAL SAO CAMILOESTEIO<br/><b> Closeness<\\/b>:44432<br/><b>Longitude: <\\/b>-51.161425<br/><b>Posição <\\/b>1<br/>\",\"<b>Código CNES: <\\/b>2262568<br/><b>Nome: <\\/b>HOSPITAL SAO LUCAS DA PUCRS<br/><b> Closeness<\\/b>:23488<br/><b>Longitude: <\\/b>-51.173383<br/><b>Posição <\\/b>13<br/>\",\"<b>Código CNES: <\\/b>3508528<br/><b>Nome: <\\/b>HOSPITAL UNIVERSITARIO ULBRA<br/><b> Closeness<\\/b>:36716<br/><b>Longitude: <\\/b>-51.166042379<br/><b>Posição <\\/b>5<br/>\",\"<b>Código CNES: <\\/b>2778718<br/><b>Nome: <\\/b>HPS PORTO ALEGRE<br/><b> Closeness<\\/b>:20232<br/><b>Longitude: <\\/b>-51.209252<br/><b>Posição <\\/b>20<br/>\",\"<b>Código CNES: <\\/b>5223962<br/><b>Nome: <\\/b>INSTITUTO DE CARDIOLOGIA HOSPITAL VIAMAO<br/><b> Closeness<\\/b>:43779<br/><b>Longitude: <\\/b>-51.030015<br/><b>Posição <\\/b>2<br/>\",\"<b>Código CNES: <\\/b>2237253<br/><b>Nome: <\\/b>IRMANDADE DA SANTA CASA DE MISERICORDIA DE PORTO ALEGRE<br/><b> Closeness<\\/b>:22054<br/><b>Longitude: <\\/b>-51.222617<br/><b>Posição <\\/b>15<br/>\"],null,null,null,null,{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]}],\"limits\":{\"lat\":[-30.09757,-29.822993],\"lng\":[-51.251219,-50.994548]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"R: Creating the table showing closeness values\"}\nclosseness <-sf::st_read(eisenberg_connection, \n                            layer = \"clossness_hospital_porto\")\nclosseness_no_geom <- closseness |>  \n                          arrange(ds_cnes, closeness) |>\n                          mutate(lng= \n                              unlist(map(geom_hospital,1)),\n                           lat=\n                              unlist(map(geom_hospital,2)),\n                           closeness_norm = \n                          (closseness$closeness - min(closseness$closeness)) / (max(closseness$closeness) - min(closseness$closeness)) * 100,\n                          position = rank(-closeness),\n                          ds_cnes =stringr::str_to_title(ds_cnes)) |>\n                  sf::st_drop_geometry()\n\nDT::datatable(subset(closseness_no_geom, select=c(\"position\",\"cd_cnes\",\"ds_cnes\",\"closeness\")),\n              extensions=\"Buttons\",\n                         options=list(\n                           dom=\"Bfrtip\",\n                           buttons=c(\"copy\",\"csv\",\"pdf\"),\n                            initComplete = JS(\n    \"function(settings, json) {\",\n    \"$(this.api().table().header()).css({'background-color': '#d50038', 'color': '#fff'});\",\n    \"}\")\n                                  )\n              ) |> \n    DT::formatStyle(\"closeness\",\n              background=DT::styleColorBar(range(closseness_no_geom$closeness),'#ee8b8b'),\n                backgroundSize = '98% 88%',\n  backgroundRepeat = 'no-repeat',\n  backgroundPosition = 'center') \n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-8907fe5297d34d5d020d\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-8907fe5297d34d5d020d\">{\"x\":{\"filter\":\"none\",\"vertical\":false,\"extensions\":[\"Buttons\"],\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\"],[7,9,18,8,4,19,17,11,12,14,3,10,16,6,1,13,5,20,2,15],[2237156,2265060,2237601,2237598,2232049,3567664,2265052,7092571,3007847,3006522,2232162,2237571,5026253,3626245,2232030,2262568,3508528,2778718,5223962,2237253],[\"Hbmpa\",\"Hospital Cristo Redentor Sa\",\"Hospital De Clinicas\",\"Hospital Divina Providencia\",\"Hospital Dom Joao Becker\",\"Hospital Ernesto Dornelles\",\"Hospital Femina Sa\",\"Hospital Independencia\",\"Hospital Mae De Deus\",\"Hospital Moinhos De Vento\",\"Hospital Municipal Getulio Vargassapucaia Do Sul\",\"Hospital Nossa Senhora Da Conceicao Sa\",\"Hospital Porto Alegre\",\"Hospital Pronto Socorro De Canoas Dep Nelson Marchezan\",\"Hospital Sao Camiloesteio\",\"Hospital Sao Lucas Da Pucrs\",\"Hospital Universitario Ulbra\",\"Hps Porto Alegre\",\"Instituto De Cardiologia Hospital Viamao\",\"Irmandade Da Santa Casa De Misericordia De Porto Alegre\"],[33157,26550,20727,28389,37981,20444,21010,26059,25359,22118,42543,26301,21012,35663,44432,23488,36716,20232,43779,22054]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>position<\\/th>\\n      <th>cd_cnes<\\/th>\\n      <th>ds_cnes<\\/th>\\n      <th>closeness<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"dom\":\"Bfrtip\",\"buttons\":[\"copy\",\"csv\",\"pdf\"],\"initComplete\":\"function(settings, json) {\\n$(this.api().table().header()).css({'background-color': '#d50038', 'color': '#fff'});\\n}\",\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[1,2,4]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"position\",\"targets\":1},{\"name\":\"cd_cnes\",\"targets\":2},{\"name\":\"ds_cnes\",\"targets\":3},{\"name\":\"closeness\",\"targets\":4}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"rowCallback\":\"function(row, data, displayNum, displayIndex, dataIndex) {\\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background':isNaN(parseFloat(value)) || value <= 20232.000000 ? '' : 'linear-gradient(90.000000deg, transparent ' + Math.max(44432.000000 - value, 0)/24200.000000 * 100 + '%, #ee8b8b ' + Math.max(44432.000000 - value, 0)/24200.000000 * 100 + '%)','background-size':'98% 88%','background-repeat':'no-repeat','background-position':'center'});\\n}\"}},\"evals\":[\"options.initComplete\",\"options.rowCallback\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n## RQ2:  Accessibility analysis\n\n> Which healthcare facilities will be most affected by flooding based on accessibility\nmetrics?\n\n### Sum Edge Betweenness:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"R: Visualizing the accesibility most affected from healtchare facilities based on betweenness centrality\"}\n## Eisenberg\nhospitals_betweenness_pre <- st_read(eisenberg_connection, \"centrality_424_hospitals_porto_end_id_centrality\") \nhospitals_betweenness_post <- st_read(eisenberg_connection,\"centrality_424_hospitals_porto_end_id_centrality_post\")\n### Locally\nhospitals_betweenness_pre_local <- st_read(eisenberg_connection, Id(schema=\"heigit\", table = \"centrality_424_hospitals_porto_end_id_centrality_group\"))\nhospitals_betweenness_post_local <- st_read(eisenberg_connection, Id(schema=\"heigit\", table = \"centrality_424_hospitals_porto_end_id_centrality_post_group\"))\nhospitals_betweenness_pre_local$event <- \"pre-event\"\nhospitals_betweenness_post_local$event <- \"post-event\"\n## Import\nhospitals_betweenness_both_long <- hospitals_betweenness_pre_local |> bind_rows(hospitals_betweenness_post_local) |> subset(select=c(\"cd_cnes\",\"ds_cnes\",\"max_centrality\",\"event\")) |> pivot_wider(\n    names_from = event,\n    values_from = max_centrality,\n  ) |>  rename( betwenness_pre= `pre-event`,\n                betwenness_post= `post-event`) \nhospitals_betweenness_both_long[is.na(hospitals_betweenness_both_long)] <- 0    \n## pivot\nhospitals_betweenness_long <- hospitals_betweenness_both_long |>\n                                  mutate(diff_betweenness_percent =\n                                           (betwenness_post-betwenness_pre)/(betwenness_pre)*100,\n                                         diff = betwenness_post-betwenness_pre,\n                                         letter = LETTERS[1:22])  |>\n  arrange(letter) |> \n                             pivot_longer(\n                                     c(betwenness_pre,betwenness_post),\n                                      names_to=\"betweenness_type\",\n                                      values_to=\"betweenness_value\") \n                   \nhospitals_betweenness_long_pre <- \n  hospitals_betweenness_long |>\n            filter(betweenness_type == \"betwenness_pre\")\nhospitals_betweenness_long_post <- \n  hospitals_betweenness_long |>\n  filter(betweenness_type == \"betwenness_post\")\n##\n\ndf_labels_betweenness <- hospitals_betweenness_long |> \n  group_by(letter) |> \n  summarize(midpoint = mean(betweenness_value), \n            diff_betweenness_percent = first(diff_betweenness_percent))\n##\np <- ggplot(hospitals_betweenness_long, aes(x=betweenness_value, y=reorder(letter, desc(diff_betweenness_percent)))) +\n  geom_segment(data=hospitals_betweenness_long_pre,\n               aes(x=betweenness_value, y = letter,\n                   yend=hospitals_betweenness_long_post$letter, xend=hospitals_betweenness_long_post$betweenness_value)) +\n  geom_point(aes(x=betweenness_value, y = letter, color = betweenness_type, size=2.5))  +\n  geom_text(data = df_labels_betweenness, aes(x = midpoint, y = letter, label = paste0(round(diff_betweenness_percent,2), \" %\")), \n            vjust = 1.5, size = 3.5, color = \"red\") +\n    geom_text(aes(label = betweenness_value, color = betweenness_type), vjust = -1, size=3.5) +  # Label the points with centrality_value\n   scale_color_brewer(palette = \"Set1\", direction = 1) +\n  scale_y_discrete(expand=c(0.05,0.05)) +\n  theme_minimal() +\n  labs(title = \"Centrality analysis\",\n       subtitle= \"Change of centrality based on sum edge betweenness in hospitals\",\n       y = \" Hospitals\",\n       x = \"Sum Edge Betweenness\") +\n  theme(plot.title=element_text(family =\"bold\", hjust=0.5),\n        axis.text.y = element_text(size = 16),\n        plot.subtitle = element_text(colour=\"#626262\", hjust=0.5),\n        legend.position='bottom') \n\n### table\n\ndf_hospitals_betweenness_both_compare <- hospitals_betweenness_both_long |> \n                                              mutate(diff_betweenness_percent = \n                                                          round((betwenness_post-betwenness_pre)/(betwenness_pre)*100,2),\n                                                      diff = betwenness_post-betwenness_pre,\n                                                      letter = LETTERS[1:22],\n                                                      ds_cnes = stringr::str_to_title(ds_cnes))\n                                                  \n  \nDT::datatable(subset(df_hospitals_betweenness_both_compare,\n                     select=c(\"letter\",\"cd_cnes\",\"ds_cnes\",\"betwenness_pre\",\"betwenness_post\",\"diff_betweenness_percent\")),\n              colnames=c(\"ID\",\"Code\",\"Name\",\"Betweenness Pre\",\"Betweenness Post\",\"Diff(%)\"),\n              filter=\"top\",\n              extensions=\"Buttons\",\n                         options=list(\n                           dom=\"Bfrtip\",\n                           buttons=c(\"copy\",\"csv\",\"pdf\"),\n                            initComplete = JS(\n    \"function(settings, json) {\",\n    \"$(this.api().table().header()).css({'background-color': '#d50038', 'color': '#fff'});\",\n    \"}\")\n                                  )\n              ) |> \n    DT::formatStyle(\"betwenness_pre\",\n              background=DT::styleColorBar(range(df_hospitals_betweenness_both_compare$betwenness_pre),'#ee8b8b'),\n                backgroundSize = '98% 88%',\n  backgroundRepeat = 'no-repeat',\n  backgroundPosition = 'center') |>\n    DT::formatStyle(\"betwenness_post\",\n              background=DT::styleColorBar(range(df_hospitals_betweenness_both_compare$betwenness_pre),'#8ba1b3'),\n                backgroundSize = '98% 88%',\n  backgroundRepeat = 'no-repeat',\n  backgroundPosition = 'center')\n```\n:::\n\n\n### Closeness:\n\n\n::: {.cell}\n\n:::\n\n\n![](/media/accessibility_test2.png)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"R: Changes on the accesibiliy based on closeness\"}\nhospitals_closeness_both <- st_read(eisenberg_connection, \"hospitals_closeness_both\") \ndf_hospitals_closeness_both_compare <- hospitals_closeness_both |> \n                                              mutate(diff_closeness_percent = \n                                                          round((closeness_post-closeness_pre)/(closeness_pre)*100,2),\n                                                      diff = closeness_post-closeness_pre,\n                                                      letter = LETTERS[1:20],\n                                                      ds_cnes = stringr::str_to_title(ds_cnes)) |> \n                                                  sf::st_drop_geometry() \n                                                  \n  \nDT::datatable(subset(df_hospitals_closeness_both_compare,\n                     select=c(\"letter\",\"cd_cnes\",\"ds_cnes\",\"closeness_pre\",\"closeness_post\",\"diff_closeness_percent\")),\n              colnames=c(\"ID\",\"Code\",\"Name\",\"Closeness Pre\",\"Closeness Post\",\"Diff(%)\"),\n              filter=\"top\",\n              extensions=\"Buttons\",\n                         options=list(\n                           dom=\"Bfrtip\",\n                           buttons=c(\"copy\",\"csv\",\"pdf\"),\n                            initComplete = JS(\n    \"function(settings, json) {\",\n    \"$(this.api().table().header()).css({'background-color': '#d50038', 'color': '#fff'});\",\n    \"}\")\n                                  )\n              ) |> \n    DT::formatStyle(\"closeness_pre\",\n              background=DT::styleColorBar(range(df_hospitals_closeness_both_compare$closeness_pre),'#ee8b8b'),\n                backgroundSize = '98% 88%',\n  backgroundRepeat = 'no-repeat',\n  backgroundPosition = 'center') |>\n    DT::formatStyle(\"closeness_post\",\n              background=DT::styleColorBar(range(df_hospitals_closeness_both_compare$closeness_pre),'#8ba1b3'),\n                backgroundSize = '98% 88%',\n  backgroundRepeat = 'no-repeat',\n  backgroundPosition = 'center')\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"datatables html-widget html-fill-item\" id=\"htmlwidget-fbaa1d9be61e980532e5\" style=\"width:100%;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-fbaa1d9be61e980532e5\">{\"x\":{\"filter\":\"top\",\"vertical\":false,\"filterHTML\":\"<tr>\\n  <td><\\/td>\\n  <td data-type=\\\"character\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"2232030\\\" data-max=\\\"7092571\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"character\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"20232\\\" data-max=\\\"44432\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"integer\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"0\\\" data-max=\\\"27498\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n  <td data-type=\\\"number\\\" style=\\\"vertical-align: top;\\\">\\n    <div class=\\\"form-group has-feedback\\\" style=\\\"margin-bottom: auto;\\\">\\n      <input type=\\\"search\\\" placeholder=\\\"All\\\" class=\\\"form-control\\\" style=\\\"width: 100%;\\\"/>\\n      <span class=\\\"glyphicon glyphicon-remove-circle form-control-feedback\\\"><\\/span>\\n    <\\/div>\\n    <div style=\\\"display: none;position: absolute;width: 200px;opacity: 1\\\">\\n      <div data-min=\\\"-100\\\" data-max=\\\"-37.19\\\" data-scale=\\\"2\\\"><\\/div>\\n      <span style=\\\"float: left;\\\"><\\/span>\\n      <span style=\\\"float: right;\\\"><\\/span>\\n    <\\/div>\\n  <\\/td>\\n<\\/tr>\",\"extensions\":[\"Buttons\"],\"data\":[[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\",\"10\",\"11\",\"12\",\"13\",\"14\",\"15\",\"16\",\"17\",\"18\",\"19\",\"20\"],[\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\",\"I\",\"J\",\"K\",\"L\",\"M\",\"N\",\"O\",\"P\",\"Q\",\"R\",\"S\",\"T\"],[2232030,2232049,2232162,2237156,2237253,2237571,2237598,2237601,2262568,2265052,2265060,2778718,3006522,3007847,3508528,3567664,3626245,5026253,5223962,7092571],[\"Hospital Sao Camiloesteio\",\"Hospital Dom Joao Becker\",\"Hospital Municipal Getulio Vargassapucaia Do Sul\",\"Hbmpa\",\"Irmandade Da Santa Casa De Misericordia De Porto Alegre\",\"Hospital Nossa Senhora Da Conceicao Sa\",\"Hospital Divina Providencia\",\"Hospital De Clinicas\",\"Hospital Sao Lucas Da Pucrs\",\"Hospital Femina Sa\",\"Hospital Cristo Redentor Sa\",\"Hps Porto Alegre\",\"Hospital Moinhos De Vento\",\"Hospital Mae De Deus\",\"Hospital Universitario Ulbra\",\"Hospital Ernesto Dornelles\",\"Hospital Pronto Socorro De Canoas Dep Nelson Marchezan\",\"Hospital Porto Alegre\",\"Instituto De Cardiologia Hospital Viamao\",\"Hospital Independencia\"],[44432,37981,42543,33157,22054,26301,28389,20727,23488,21010,26550,20232,22118,25359,36716,20444,35663,21012,43779,26059],[2998,4712,3676,19324,13658,15471,14780,11808,12103,12254,16099,11464,13616,0,3460,11246,0,0,27498,13394],[-93.25,-87.59,-91.36,-41.72,-38.07,-41.18,-47.94,-43.03,-48.47,-41.68,-39.36,-43.34,-38.44,-100,-90.58,-44.99,-100,-100,-37.19,-48.6]],\"container\":\"<table class=\\\"display\\\">\\n  <thead>\\n    <tr>\\n      <th> <\\/th>\\n      <th>ID<\\/th>\\n      <th>Code<\\/th>\\n      <th>Name<\\/th>\\n      <th>Closeness Pre<\\/th>\\n      <th>Closeness Post<\\/th>\\n      <th>Diff(%)<\\/th>\\n    <\\/tr>\\n  <\\/thead>\\n<\\/table>\",\"options\":{\"dom\":\"Bfrtip\",\"buttons\":[\"copy\",\"csv\",\"pdf\"],\"initComplete\":\"function(settings, json) {\\n$(this.api().table().header()).css({'background-color': '#d50038', 'color': '#fff'});\\n}\",\"columnDefs\":[{\"className\":\"dt-right\",\"targets\":[2,4,5,6]},{\"orderable\":false,\"targets\":0},{\"name\":\" \",\"targets\":0},{\"name\":\"letter\",\"targets\":1},{\"name\":\"cd_cnes\",\"targets\":2},{\"name\":\"ds_cnes\",\"targets\":3},{\"name\":\"closeness_pre\",\"targets\":4},{\"name\":\"closeness_post\",\"targets\":5},{\"name\":\"diff_closeness_percent\",\"targets\":6}],\"order\":[],\"autoWidth\":false,\"orderClasses\":false,\"orderCellsTop\":true,\"rowCallback\":\"function(row, data, displayNum, displayIndex, dataIndex) {\\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background':isNaN(parseFloat(value)) || value <= 20232.000000 ? '' : 'linear-gradient(90.000000deg, transparent ' + Math.max(44432.000000 - value, 0)/24200.000000 * 100 + '%, #ee8b8b ' + Math.max(44432.000000 - value, 0)/24200.000000 * 100 + '%)','background-size':'98% 88%','background-repeat':'no-repeat','background-position':'center'});\\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'background':isNaN(parseFloat(value)) || value <= 20232.000000 ? '' : 'linear-gradient(90.000000deg, transparent ' + Math.max(44432.000000 - value, 0)/24200.000000 * 100 + '%, #8ba1b3 ' + Math.max(44432.000000 - value, 0)/24200.000000 * 100 + '%)','background-size':'98% 88%','background-repeat':'no-repeat','background-position':'center'});\\n}\"}},\"evals\":[\"options.initComplete\",\"options.rowCallback\"],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\n\n## RQ3: Critical infrastructures\n\n> Where are the most critical infrastructures located for accessing health facilities\nto reinforce urban resilience against flooding?",
    "supporting": [
      "results_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"site_libs/jquery-3.6.0/jquery-3.6.0.min.js\"></script>\n<link href=\"site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/leaflet-1.3.1/leaflet.js\"></script>\n<link href=\"site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/proj4-2.6.2/proj4.min.js\"></script>\n<script src=\"site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\n<link href=\"site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/leaflet-binding-2.2.2/leaflet.js\"></script>\n<script src=\"site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js\"></script>\n<script src=\"site_libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js\"></script>\n<link href=\"site_libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.min.js\"></script>\n<link href=\"site_libs/fontawesome-4.7.0/font-awesome.min.css\" rel=\"stylesheet\" />\n<link href=\"site_libs/datatables-css-0.0.0/datatables-crosstalk.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/datatables-binding-0.33/datatables.js\"></script>\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css\" rel=\"stylesheet\" />\n<link href=\"site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js\"></script>\n<script src=\"site_libs/pdfmake-1.13.6/pdfmake.js\"></script>\n<script src=\"site_libs/pdfmake-1.13.6/vfs_fonts.js\"></script>\n<link href=\"site_libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js\"></script>\n<script src=\"site_libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js\"></script>\n<script src=\"site_libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js\"></script>\n<script src=\"site_libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js\"></script>\n<link href=\"site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"site_libs/nouislider-7.0.10/jquery.nouislider.min.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/nouislider-7.0.10/jquery.nouislider.min.js\"></script>\n<link href=\"site_libs/selectize-0.12.0/selectize.bootstrap3.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/selectize-0.12.0/selectize.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}