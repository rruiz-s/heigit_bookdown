<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Internship Report">

<title>Connectivity for Disaster Resiliance - 3&nbsp; Results</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./conclussion.html" rel="next">
<link href="./methodology.html" rel="prev">
<link href="./final_logo.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.33/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<script src="site_libs/pdfmake-1.13.6/pdfmake.js"></script>
<script src="site_libs/pdfmake-1.13.6/vfs_fonts.js"></script>
<link href="site_libs/dt-ext-buttons-1.13.6/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="site_libs/dt-ext-buttons-1.13.6/js/dataTables.buttons.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.html5.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.colVis.min.js"></script>
<script src="site_libs/dt-ext-buttons-1.13.6/js/buttons.print.min.js"></script>
<link href="site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="site_libs/selectize-0.12.0/selectize.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-1.3.1/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="site_libs/proj4-2.6.2/proj4.min.js"></script>
<script src="site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="site_libs/leaflet-binding-2.2.2/leaflet.js"></script>
<script src="site_libs/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script>
<script src="site_libs/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script>
<link href="site_libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.css" rel="stylesheet">
<script src="site_libs/leaflet-awesomemarkers-2.0.3/leaflet.awesome-markers.min.js"></script>
<link href="site_libs/fontawesome-4.7.0/font-awesome.min.css" rel="stylesheet">


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./results.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./final_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Connectivity for Disaster Resiliance</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/ddotta/cookbook-rpolars/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./methodology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Methodology</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./results.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conclussion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Conclussion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./future_work.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Future work &amp; suggestions</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Performance tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link active" data-scroll-target="#data-preparation"><span class="header-section-number">3.1</span> Data preparation</a>
  <ul class="collapse">
  <li><a href="#osm-ors-data" id="toc-osm-ors-data" class="nav-link" data-scroll-target="#osm-ors-data"><span class="header-section-number">3.1.1</span> OSM &amp; ORS data</a></li>
  </ul></li>
  <li><a href="#rq1-centrality-analysis" id="toc-rq1-centrality-analysis" class="nav-link" data-scroll-target="#rq1-centrality-analysis"><span class="header-section-number">3.2</span> RQ1: Centrality analysis</a>
  <ul class="collapse">
  <li><a href="#sum-edge-betweenness" id="toc-sum-edge-betweenness" class="nav-link" data-scroll-target="#sum-edge-betweenness"><span class="header-section-number">3.2.1</span> Sum Edge Betweenness</a></li>
  </ul></li>
  <li><a href="#rq2-accessibility-analysis" id="toc-rq2-accessibility-analysis" class="nav-link" data-scroll-target="#rq2-accessibility-analysis"><span class="header-section-number">3.3</span> RQ2: Accessibility analysis</a>
  <ul class="collapse">
  <li><a href="#sum-edge-betweenness-1" id="toc-sum-edge-betweenness-1" class="nav-link" data-scroll-target="#sum-edge-betweenness-1"><span class="header-section-number">3.3.1</span> Sum Edge Betweenness:</a></li>
  <li><a href="#closeness" id="toc-closeness" class="nav-link" data-scroll-target="#closeness"><span class="header-section-number">3.3.2</span> Closeness:</a></li>
  </ul></li>
  <li><a href="#rq3-critical-infrastructures" id="toc-rq3-critical-infrastructures" class="nav-link" data-scroll-target="#rq3-critical-infrastructures"><span class="header-section-number">3.4</span> RQ3: Critical infrastructures</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Results</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Key variables: - Centrality — connectivity - Accessibility —- vulnerability-resilience</p>
<section id="data-preparation" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="data-preparation"><span class="header-section-number">3.1</span> Data preparation</h2>
<section id="osm-ors-data" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="osm-ors-data"><span class="header-section-number">3.1.1</span> OSM &amp; ORS data</h3>
<p>The area of interest covered 1331 km² of surface including 9 municipalities with 20 healthcare facilities. On this area, the road network included 2463 components with a total length of 9039 km. The selected component for the centrality analysis represented the 96.53% of this total, with a length of 8720 km. The transformed graph network contained 75384 target nodes, 75184 source nodes, and 175608 edges. Classified as a large settlement <span class="citation" data-cites="european_commission_joint_research_centre_ghsl_2023">(<a href="references.html#ref-european_commission_joint_research_centre_ghsl_2023" role="doc-biblioref">European Commission. Joint Research Centre. 2023</a>)</span>, the estimated population from the GHSl-SMOD was 2728133 with a total built up area of 147 km².</p>
<p>A total of 100 origin and 100 destination generated 9994 shortest paths. The initial naive approach using the regular sampling method generated these points in fields and non-populated areas, which would have skewed the representation of the population distribution. This would have resulted in increasing the centrality of roads that are less relevant to the population’s movement patterns during the flooding event. Therefore, using the weighted sampling based on the built-up areas provided a closer model representation of the flooding phenomena.</p>
<p>After subdividing the flooding extent and adjusting it to the Area of Interest (AoI), the flooding covered 441 km² instead of the original 7103 km². This operation allowed to create the post-flooding road network with less computing costs by only selecting the flooding extent that intersected with the AoI. This post-flooding network with a length of 1926 km included the components 21, 14 and 5187, summing up a total of 63458 vertices against the 75384 vertices from the pre-flooding network. When compared to the network before the flooding, the post-network network reduced its length by -16 % , representing a loss of -2556 km.</p>
<div class="cell">
<details>
<summary>PostGIS: Result from the responsive code to import OSM</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Osmium command</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>osmium extract <span class="sc">-</span>b <span class="sc">-</span><span class="fl">51.2791</span>,<span class="sc">-</span><span class="fl">30.1722</span>,<span class="sc">-</span><span class="fl">50.9407</span>,<span class="sc">-</span><span class="fl">29.8048</span> sul<span class="fl">-240501.</span>osm.pbf <span class="sc">-</span>o puerto_alegre_urban_center.osm.pbf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>

<iframe width="760" height="500" src="./media/map_sampling_example_v1.html" title="Inspect of the components in the graph network "></iframe>
<div class="cell">
<details>
<summary>R: Visualizing regular and weighted sampling</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Crop and Reproject</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="do">## gdalwarp -te -4850853.201784615 -3737074.296348413 -4616291.881935796 -3495378.804761388 GHS_BUILT_V_E2020_GLOBE_R2023A_54009_100_V1_0.tif GHS_BUILT_V_E2020_GLOBE_R2023A_54009_100_V</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">## gdalwarp -t_srs "EPSG:4326" GHS_BUILT_V_E2020_GLOBE_R2023A_54009_100_V1_0_RioGrandeDoSul.tif GHS_BUILT_V_E2020_GLOBE_R2023A_4326_100_V1_0_RioGrandeDoSul.tif</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> mapview<span class="sc">::</span><span class="fu">mapviewPalette</span>(<span class="st">"mapviewTopoColors"</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>ghs_build <span class="ot">&lt;-</span> <span class="fu">stack</span>(<span class="st">"/home/ricardo/heigit_bookdown/data/GHS_BUILT_V_E2020_GLOBE_R2023A_4326_100_V1_0_RioGrandeDoSul.tif"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>ghs_smod <span class="ot">&lt;-</span> <span class="fu">stack</span>(<span class="st">"/home/ricardo/heigit_bookdown/data/GHS_SMOD_E2020_GLOBE_R2023A_4326_1000_V2_0_RioGrandeDoSul.tif"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>ghs_smod_terra <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">rast</span>(<span class="st">"/home/ricardo/heigit_bookdown/data/GHS_SMOD_E2020_GLOBE_R2023A_4326_1000_V2_0_RioGrandeDoSul.tif"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>regular_sampling <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"/home/ricardo/heigit_bookdown/data/random_points_snapped.geojson"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>regular_sampling_100 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(regular_sampling, <span class="at">size =</span> <span class="dv">100</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>weighted_sampling_origin <span class="ot">&lt;-</span> <span class="fu">st_read</span>(eisenberg_connection,<span class="st">"weight_sampling_100_origin"</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>weighted_sampling_destination <span class="ot">&lt;-</span> <span class="fu">st_read</span>(eisenberg_connection,<span class="st">"weight_sampling_100_destination"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>nuts <span class="ot">&lt;-</span> <span class="fu">st_read</span>(eisenberg_connection, <span class="st">"nuts"</span>)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>weighted_sampling_origin<span class="sc">$</span>sample <span class="ot">&lt;-</span> <span class="st">"origin"</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>weighted_sampling_destination<span class="sc">$</span>sample <span class="ot">&lt;-</span> <span class="st">"destination"</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>weighted_sampling_both <span class="ot">&lt;-</span> <span class="fu">rbind</span>(weighted_sampling_origin,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                                weighted_sampling_destination )</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>weighted_sampling <span class="ot">&lt;-</span> weighted_sampling_both <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">as.factor</span>(weighted_sampling_both<span class="sc">$</span>sample))</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>poi_hospital <span class="ot">&lt;-</span> <span class="fu">st_read</span>(eisenberg_connection,<span class="st">"hospital_rs_node_v2"</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">0</span>, <span class="dv">10</span>, <span class="cn">NA</span>,   <span class="co"># Values &gt;= 0 and &lt;= 10 become 0</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">10</span>, <span class="dv">13</span>, <span class="dv">1</span>,  <span class="co"># Values &gt; 10 and &lt;= 21 become 1</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">13</span>, <span class="dv">29</span>, <span class="dv">2</span>,  <span class="co"># Values &gt; 21 and &lt;= 29 become 2</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="dv">30</span>, <span class="dv">30</span>, <span class="dv">3</span>   <span class="co"># Values == 30 become 3</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>), <span class="at">ncol =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="do">## Classify using the correct matrix</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>rc2 <span class="ot">&lt;-</span> <span class="fu">classify</span>(ghs_smod_terra, m, <span class="at">include.lowest=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>rc2_factor <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(rc2)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(rc2_factor) <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,    <span class="co"># These should match the values in the classification</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">category =</span> <span class="fu">c</span>(<span class="st">"Rural: 10-13"</span>, <span class="st">"Suburban: 13-29"</span>, <span class="st">"Urban Center: 30"</span>)</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>category_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#008f44"</span>,<span class="st">"#dedb96"</span>, <span class="st">"#cc9152"</span>)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(ghs_build[[<span class="dv">1</span>]],</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>        <span class="at">layer.name =</span><span class="st">"Built-up volume"</span>,</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.regions =</span> <span class="fu">pal</span>(<span class="dv">100</span>),</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">alpha.regions=</span> <span class="fl">0.45</span>,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">hide=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapview</span>(ghs_smod[[<span class="dv">1</span>]],</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>          <span class="at">layer.name =</span> <span class="st">"Settlement classification"</span>,</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>          <span class="at">col.regions =</span> <span class="fu">pal</span>(<span class="dv">100</span>),</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha.regions=</span> <span class="fl">0.35</span>,</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>          <span class="at">hide=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapview</span>(weighted_sampling,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>          <span class="at">layer.name=</span><span class="st">"Weighted samples"</span>,</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>          <span class="at">zcol=</span><span class="st">"sample"</span>,</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>          <span class="at">col.regions=</span><span class="fu">c</span>(<span class="st">"#2D5CA4"</span>,<span class="st">"#00A3A0"</span>),</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>          <span class="at">hide=</span><span class="cn">TRUE</span>,</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex=</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapview</span>()</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapview</span>(regular_sampling_100,</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"darkgray"</span>,</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>          <span class="at">col.regions=</span><span class="st">"darkgray"</span>,</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex=</span> <span class="dv">3</span>,</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend=</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>          <span class="at">hide=</span><span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mapview</span>(<span class="fu">subset</span>(poi_hospital,</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>                 <span class="at">select=</span><span class="fu">c</span>(<span class="st">"cd_cnes"</span>,</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"ds_cnes"</span>,</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"id"</span>,</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>                          <span class="st">"geom_hospital"</span>)),</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>          <span class="at">layer.name =</span> <span class="st">"POI - Hospitals"</span>,</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>          <span class="at">color=</span> <span class="st">"darkred"</span>,</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>          <span class="at">col.regions=</span><span class="st">"#CA2334"</span>,</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>          <span class="at">popup=</span><span class="fu">popupTable</span>(poi_hospital, <span class="at">zcol=</span><span class="fu">c</span>(<span class="st">"cd_cnes"</span>,<span class="st">"ds_cnes"</span>,<span class="st">"id"</span>))) <span class="sc">+</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a><span class="fu">mapview</span>(flooding,</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>            <span class="at">color=</span><span class="st">"darkblue"</span>,</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha.regions=</span> <span class="fl">0.5</span>,</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>        <span class="at">hide =</span><span class="cn">TRUE</span>,</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>            <span class="at">layer.name=</span><span class="st">"Flooding layer"</span>) <span class="sc">+</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>    mapview<span class="sc">::</span><span class="fu">mapview</span>(prueba_largest_network_post,</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lwd =</span> <span class="fl">0.2</span>,</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color=</span><span class="st">"#cb2a32"</span>,</span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>                     <span class="at">hide =</span> <span class="cn">TRUE</span>,</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>                     <span class="at">layer.name =</span><span class="st">"Post-flooding network"</span>) <span class="sc">+</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>    mapview<span class="sc">::</span><span class="fu">mapview</span>(pre_network_largest,</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>                     <span class="at">color =</span> <span class="st">"#00a4a4"</span>,</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>                     <span class="at">lwd=</span> <span class="fl">0.2</span>,</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>                     <span class="at">hide=</span><span class="cn">TRUE</span>,</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>                     <span class="at">layer.name =</span><span class="st">"Pre-flooding network"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="rq1-centrality-analysis" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="rq1-centrality-analysis"><span class="header-section-number">3.2</span> RQ1: Centrality analysis</h2>
<blockquote class="blockquote">
<p>How does road connectivity change after being impacted by flooding based on connectivity metrics?</p>
</blockquote>
<section id="sum-edge-betweenness" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="sum-edge-betweenness"><span class="header-section-number">3.2.1</span> Sum Edge Betweenness</h3>
<p>The average sum edge betweenness before the flooding was 96, being decreased to 58 after the flooding. In contrast, the flooding caused a -65 % decrease on the maximum values, reducing the sum edge betweenness from 1644 to 582. Prior to the event, the 30% of the network that extended over 579 km, accounted for 69 % of the overall connectivity adding 1448245 to the network. After the event, the upper quartile of the network, with a length of 363km, maintained 70% of the total centrality, however, it only contributed 701092 to the sum edge betweenness.</p>
<div class="cell">
<details>
<summary>R: Visualizing changes of centrality on the network before and after the flooding calculated with pgrouting</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">### natural breaks</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">#### For pre-event: 1644, 468, 142</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>centrality_pre<span class="sc">$</span>centrality_fct <span class="ot">&lt;-</span> <span class="fu">cut</span>(centrality_pre<span class="sc">$</span>centrality,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">142</span>,<span class="dv">468</span>,<span class="dv">1644</span>),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels =</span><span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"medium"</span>,<span class="st">"high"</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">include.lowest=</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">right =</span><span class="cn">FALSE</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="do">#### natural breaks:  81, 230, 582</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>centrality_post<span class="sc">$</span>centrality_fct <span class="ot">&lt;-</span> <span class="fu">cut</span>(centrality_post<span class="sc">$</span>centrality,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">81</span>,<span class="dv">230</span>,<span class="dv">582</span>),</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels =</span><span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"medium"</span>,<span class="st">"high"</span>),</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">include.lowest=</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">right =</span><span class="cn">FALSE</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="do">### </span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>centrality_pre_map <span class="ot">&lt;-</span> mapview<span class="sc">::</span><span class="fu">mapview</span>(centrality_pre,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">zcol=</span><span class="st">"centrality_fct"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">lwd =</span><span class="st">"centrality"</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">layer.name =</span><span class="st">"Centrality Pre-Event"</span>,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>              <span class="at">popup=</span><span class="fu">popupTable</span>(centrality_pre, </span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                               <span class="at">zcol=</span><span class="fu">c</span>(<span class="st">"id"</span>,<span class="st">"centrality"</span>,<span class="st">"bidirectid"</span>))) </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>centrality_post_map <span class="ot">&lt;-</span> mapview<span class="sc">::</span><span class="fu">mapview</span>(centrality_post,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">zcol=</span><span class="st">"centrality_fct"</span>,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">lwd =</span> <span class="st">"centrality"</span>,</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">layer.name =</span><span class="st">"Centrality Post-Event"</span>,</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">popup=</span><span class="fu">popupTable</span>(centrality_pre, </span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>                               <span class="at">zcol=</span><span class="fu">c</span>(<span class="st">"id"</span>,<span class="st">"centrality"</span>,<span class="st">"bidirectid"</span>))) </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>centrality_pre_map <span class="sc">|</span> centrality_post_map <span class="sc">+</span> <span class="fu">mapview</span>(flooding,</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>          <span class="at">color=</span><span class="st">"darkblue"</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">alpha.regions=</span> <span class="fl">0.5</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">layer.name=</span><span class="st">"Flooding layer"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>

<iframe width="760" height="500" src="./media/centrality_map_results.html" title="Sum Edge Betweenness in the Urban Settlement located in Porto Alegre "></iframe>
<p>The most central road segments were georeferenced to reveal the name of these identified critical roads. It is found that urban arteries such as Freeway Anchieta or Avenida Presidente Castello Branco lost their entire centrality after the flooding. Other roads such as Avenida Teresópolis or Avenida Manoel Elias, Jadim Leopoldina, even being affected by the flooding, only lost their centrality partially.In contrast, roads which were not used before the flooding, such as those located nearby Costa do Morro, Itacolomi or Costa do Ipiranga, were used after the flooding event. These results are shown in the table 1 and mapped in the figure 1.</p>
<div class="cell">
<details>
<summary>R: Table of the most central road segments georeferenced</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Categories for pre-flooding or post-flooding</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>df_centrality_pre <span class="ot">&lt;-</span> centrality_pre <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                      sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">mutate</span>(<span class="at">event =</span> <span class="st">"pre-flooding"</span>) </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>df_centrality_post <span class="ot">&lt;-</span> centrality_post <span class="sc">|&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                        sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">mutate</span>(<span class="at">event =</span> <span class="st">"post-flooding"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="do">#### For pre-event: 1644, 468, 142</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>df_centrality_pre<span class="sc">$</span>centrality_fct <span class="ot">&lt;-</span> <span class="fu">cut</span>(df_centrality_pre<span class="sc">$</span>centrality,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">142</span>,<span class="dv">468</span>,<span class="dv">1644</span>),</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels =</span><span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"medium"</span>,<span class="st">"high"</span>),</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">include.lowest=</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">right =</span><span class="cn">FALSE</span>)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="do">#### natural perk:  81, 230, 582</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>df_centrality_post<span class="sc">$</span>centrality_fct <span class="ot">&lt;-</span> <span class="fu">cut</span>(df_centrality_post<span class="sc">$</span>centrality,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">81</span>,<span class="dv">230</span>,<span class="dv">582</span>),</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">labels =</span><span class="fu">c</span>(<span class="st">"low"</span>,<span class="st">"medium"</span>,<span class="st">"high"</span>),</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">include.lowest=</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">right =</span><span class="cn">FALSE</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="do">## Join both in one dataframe</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>df_centrality_both <span class="ot">&lt;-</span> <span class="fu">left_join</span>(df_centrality_pre,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>                    df_centrality_post,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">by =</span> <span class="st">'id'</span>,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">suffix=</span><span class="fu">c</span>(<span class="st">"_pre"</span>,<span class="st">"_post"</span>)) <span class="sc">|&gt;</span>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="fu">c</span>(<span class="st">"id"</span>,<span class="st">"bidirectid_pre"</span>,<span class="st">"bidirectid_post"</span>,<span class="st">"centrality_pre"</span>,<span class="st">"centrality_post"</span>,<span class="st">"centrality_fct_pre"</span>,<span class="st">"centrality_fct_post"</span>,<span class="st">"event_post"</span>,<span class="st">"event_pre"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">centrality_post =</span> <span class="fu">replace_na</span>(centrality_post, <span class="dv">0</span>)) <span class="do">## Roads covered by the flooding appeared as NA in the post-scenario, replace tha NA value for 0</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Calculate change on centrality after being impacted by flooding </span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>df_centrality_both <span class="ot">&lt;-</span>  df_centrality_both <span class="sc">|&gt;</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">centrality_diff =</span> centrality_post<span class="sc">-</span>centrality_pre)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="do">### Obtain distribution using quantiles</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>df_centrality_both_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df_centrality_both<span class="sc">$</span>centrality_diff, <span class="at">na.rm =</span><span class="cn">TRUE</span>)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="do">### Filter the worst scenario, most negative values below second quartile</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>df_centrality_negative_outlier <span class="ot">&lt;-</span> df_centrality_both <span class="sc">|&gt;</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">filter</span>( centrality_diff <span class="sc">&lt;=</span> df_centrality_both_quantiles[<span class="dv">2</span>])</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="do">### Join with original data to obtain again geometry</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>df_centrality_negative_outlier_geom <span class="ot">&lt;-</span> df_centrality_negative_outlier <span class="sc">|&gt;</span></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">arrange</span>(centrality_diff) <span class="sc">|&gt;</span></span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">left_join</span>(centrality_pre, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">mutate</span>(<span class="at">the_geom_centroid =</span> <span class="fu">st_centroid</span>(the_geom),</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>                           <span class="at">lon =</span> <span class="fu">st_coordinates</span>(the_geom_centroid)[,<span class="dv">1</span>],</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>                           <span class="at">lat =</span> <span class="fu">st_coordinates</span>(the_geom_centroid)[,<span class="dv">2</span>])</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtain a subset of the 500 observations oredered by lowest values on centrality difference</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>df_centrality_negative_outlier_geom_unique <span class="ot">&lt;-</span> df_centrality_negative_outlier_geom <span class="sc">|&gt;</span> </span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(centrality_pre, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) </span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Reverse geocoding to obtain the address based on the centroids</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>df_centrality_negative_outlier_distinct_address <span class="ot">&lt;-</span>  tidygeocoder<span class="sc">::</span><span class="fu">reverse_geocode</span>(df_centrality_negative_outlier_geom_unique, <span class="at">lat=</span>lat, <span class="at">lon=</span>lon, <span class="at">method=</span><span class="st">"osm"</span>)</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="do">## Create ID for the found addresses (97)</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>df_centrality_negative_outlier_distinct_address<span class="sc">$</span>address_number <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">167</span>,<span class="dv">1</span>)</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>df_centrality_negative_outlier_distinct_address<span class="sc">$</span>short_address <span class="ot">&lt;-</span> <span class="fu">str_extract</span>(df_centrality_negative_outlier_distinct_address<span class="sc">$</span>address, <span class="st">"^[^,]+, [^,]+"</span>) </span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>df_centrality_negative_outlier_distinct_address<span class="sc">$</span>centrality_diff_perc <span class="ot">&lt;-</span> <span class="fu">round</span>(((df_centrality_negative_outlier_distinct_address<span class="sc">$</span>centrality_post <span class="sc">-</span> df_centrality_negative_outlier_distinct_address<span class="sc">$</span>centrality_pre) <span class="sc">/</span> df_centrality_negative_outlier_distinct_address<span class="sc">$</span>centrality_pre <span class="sc">*</span><span class="dv">100</span>),<span class="dv">2</span>)</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a><span class="do">## DT Table</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="fu">subset</span>(df_centrality_negative_outlier_distinct_address, <span class="at">select=</span><span class="fu">c</span>(<span class="st">"address_number"</span>, <span class="st">"short_address"</span>,<span class="st">"centrality_pre"</span>, <span class="st">"centrality_post"</span>,<span class="st">"centrality_diff"</span>,<span class="st">"centrality_diff_perc"</span>,<span class="st">"id"</span>,<span class="st">"source"</span>,<span class="st">"target"</span>,<span class="st">"the_geom"</span>)), </span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>              <span class="at">colnames=</span> <span class="fu">c</span>(<span class="st">"ID"</span>,<span class="st">"Address"</span>,<span class="st">"Pre-Centrality"</span>, <span class="st">"Post-Centrality"</span>,<span class="st">"Diff-Centrality"</span>,<span class="st">"Diff-Centrality(%)"</span>,<span class="st">"id_1"</span>,<span class="st">"source"</span>,<span class="st">"target"</span>,<span class="st">"the_geom"</span>),</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>              <span class="at">filter=</span><span class="st">"top"</span>,</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>              <span class="at">class=</span><span class="st">'compact'</span>, <span class="at">rownames=</span><span class="cn">FALSE</span>, <span class="at">escape=</span><span class="cn">FALSE</span>, <span class="at">caption=</span><span class="st">'Data description'</span>,</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>              <span class="at">extensions=</span><span class="fu">c</span>(<span class="st">"Buttons"</span>,<span class="st">'RowGroup'</span>),</span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>              <span class="at">options=</span><span class="fu">list</span>(</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>                  <span class="at">order=</span><span class="fu">list</span>(<span class="fu">list</span>(<span class="dv">5</span>, <span class="st">'desc'</span>), <span class="fu">list</span>(<span class="dv">2</span>,<span class="st">'desc'</span>)),  <span class="co"># Sort by the first column (index 5)</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dom=</span><span class="st">"Bfrtip"</span>,</span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>                  <span class="at">columnDefs =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">visible=</span><span class="cn">FALSE</span>, <span class="at">targets=</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>))),</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>                  <span class="at">buttons=</span><span class="fu">c</span>(<span class="st">"copy"</span>, <span class="st">"csv"</span>, <span class="st">"pdf"</span>),</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>                  <span class="at">initComplete =</span> <span class="fu">JS</span>(</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"function(settings, json) {"</span>,</span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"$(this.api().table().header()).css({'background-color': '#d50038', 'color': '#fff'});"</span>,</span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"}"</span>)</span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>      DT<span class="sc">::</span><span class="fu">formatStyle</span>(<span class="st">"centrality_pre"</span>,</span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>     <span class="at">background=</span>DT<span class="sc">::</span><span class="fu">styleColorBar</span>(<span class="fu">range</span>(df_centrality_negative_outlier_distinct_address<span class="sc">$</span>centrality_pre), <span class="st">'#ee8b8b'</span>),</span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>                    <span class="at">backgroundSize=</span><span class="st">'98% 88%'</span>,</span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>                    <span class="at">backgroundRepeat=</span><span class="st">'no-repeat'</span>,</span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>                    <span class="at">backgroundPosition=</span><span class="st">'center'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>


<iframe width="760" height="500" src="./media/centrality_table_results.html" title="Sum Edge Betweenness in the Urban Settlement located in Porto Alegre "></iframe>
<p>Regarding the distribution of the centrality, the histogram on the figure 1 represented the betweenness centrality on a log10 scale on the X-axis, while the Y axis shown the frequency of occurence for both scenarios. In both scenarios, the centrality distribution exibited strong positive skewness, with most of the values concentrated at the lower values of the edge betweenness. It is observed that the frequency of mid-range centrality values between 10 and 100 increased after the flooding event, however, the tail with larger values after 1000 was no longer present. The extreme positive centrality values found only in the pre-disaster network affected the general centrality lowering the mean.</p>
<div class="cell" data-warming="false">
<details>
<summary>R: Histogram of betweenness centrality calculated with pgrouting</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Tidy data and wrangling</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>centrality_post<span class="sc">$</span>event <span class="ot">&lt;-</span> <span class="st">"post-flooding"</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>centrality_pre<span class="sc">$</span>event <span class="ot">&lt;-</span> <span class="st">"pre-flooding"</span>  </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>centrality_both <span class="ot">&lt;-</span> <span class="fu">rbind</span>(centrality_post[,<span class="fu">c</span>(<span class="st">"id"</span>,<span class="st">"centrality"</span>,<span class="st">"event"</span>)] ,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                                   centrality_pre[,<span class="fu">c</span>(<span class="st">"id"</span>,<span class="st">"centrality"</span>,<span class="st">"event"</span>)])</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">ddply</span>(centrality_both, <span class="st">"event"</span>, summarise, <span class="at">grp.mean=</span><span class="fu">mean</span>(centrality))</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create histogram</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(centrality_both, <span class="fu">aes</span>(<span class="at">x=</span>centrality, <span class="at">fill=</span>event)) <span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">geom_histogram</span>(<span class="at">alpha=</span><span class="fl">0.4</span>,) <span class="sc">+</span> <span class="fu">scale_x_log10</span>() <span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Centrality analysis"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                      <span class="at">subtitle=</span> <span class="st">"Histogram on log10 scale"</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                      <span class="at">x =</span> <span class="st">" Betweenness centrality (centrality)"</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>                      <span class="at">y =</span> <span class="st">"Frequency (count)"</span>) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">family =</span><span class="st">"bold"</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"#626262"</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">'bottom'</span>) <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The following grouped bar plot illustrates the sum of the edge betweenness values classified by their quantiles for both events, before and after the flooding. The X-Axis is categorized in the four quantiles, while yhe y-axis summed up the betweenness values of these quartiles. In Both events a similar pattern is found, the roads belonging to the Q4 caused most of the edge beetweenness of the network. The 1344 km that comprised all the roads below the fourth quartile only contributed to 30% for the preflooding scenario connectivit” . Therefore, the findings shown an positive skewed distribution, where a small proportion of roads were responsible for the roads held responsible for the 69% of the centrality of the network.</p>
<div class="cell" data-warming="false">
<details>
<summary>R: Betweenness centrality values grouped by their quantiles calculated with pgrouting</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df_centrality_pre <span class="ot">&lt;-</span> centrality_pre <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                        sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">mutate</span>(<span class="at">event =</span> <span class="st">"pre-flooding"</span>) </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>df_centrality_post <span class="ot">&lt;-</span> centrality_post <span class="sc">|&gt;</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                          sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() <span class="sc">|&gt;</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">mutate</span>(<span class="at">event =</span> <span class="st">"post-flooding"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>df_centrality_both_barplot <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(df_centrality_pre,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                                               df_centrality_post)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="do">### percentiles</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">quantile</span>(df_centrality_both_barplot<span class="sc">$</span>centrality)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>q_pre <span class="ot">&lt;-</span> <span class="fu">quantile</span>(</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  df_centrality_pre[df_centrality_pre<span class="sc">$</span>event <span class="sc">==</span> <span class="st">'pre-flooding'</span>,]<span class="sc">$</span>centrality)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>q_post <span class="ot">&lt;-</span> <span class="fu">quantile</span>(</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  df_centrality_post[df_centrality_post<span class="sc">$</span>event <span class="sc">==</span> <span class="st">'post-flooding'</span>,]<span class="sc">$</span>centrality)</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a><span class="do">### Centrality</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>df_centrality_both_barplot_cat <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(df_centrality_both_barplot) <span class="sc">|&gt;</span> </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">centrality_cat=</span><span class="fu">as.factor</span>(<span class="fu">case_when</span>(</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    centrality <span class="sc">&lt;=</span> q_pre[<span class="dv">2</span>] <span class="sc">~</span> <span class="st">"Q1"</span>,</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>    centrality <span class="sc">&lt;=</span> q_pre[<span class="dv">3</span>] <span class="sc">~</span> <span class="st">"Q2"</span>,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>    centrality <span class="sc">&lt;=</span> q_pre[<span class="dv">4</span>] <span class="sc">~</span> <span class="st">"Q3"</span>,</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>    centrality <span class="sc">&gt;=</span> q_pre[<span class="dv">4</span>] <span class="sc">~</span> <span class="st">"Q4"</span>,</span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"missing"</span>)))  </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="do">## tidy data</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>barplot_event_cat_sum <span class="ot">&lt;-</span> df_centrality_both_barplot_cat <span class="sc">|&gt;</span> </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>                          dplyr<span class="sc">::</span><span class="fu">group_by</span>(event, centrality_cat) <span class="sc">|&gt;</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                           dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">sum_centrality =</span> <span class="fu">sum</span>(centrality))</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a><span class="co"># basic plot</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a> barplot_event_cat_sum <span class="sc">|&gt;</span>  </span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>centrality_cat,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span>sum_centrality,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>              <span class="at">fill=</span>event)) <span class="sc">+</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">width=</span><span class="fl">0.5</span>, <span class="at">position=</span><span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Centrality analysis"</span>,</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="st">"Barplot grouped by the post and pre event"</span>,</span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">" Quantiles"</span>,</span>
<span id="cb6-37"><a href="#cb6-37" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Edge betweenness"</span>) <span class="sc">+</span></span>
<span id="cb6-38"><a href="#cb6-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">family =</span><span class="st">"bold"</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb6-39"><a href="#cb6-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"#626262"</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb6-40"><a href="#cb6-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">'bottom'</span>) <span class="sc">+</span></span>
<span id="cb6-41"><a href="#cb6-41" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="results_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="rq2-accessibility-analysis" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="rq2-accessibility-analysis"><span class="header-section-number">3.3</span> RQ2: Accessibility analysis</h2>
<blockquote class="blockquote">
<p>Which healthcare facilities will be most affected by flooding based on accessibility metrics?</p>
</blockquote>
<section id="sum-edge-betweenness-1" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="sum-edge-betweenness-1"><span class="header-section-number">3.3.1</span> Sum Edge Betweenness:</h3>
<div class="cell">
<details>
<summary>R: Visualizing the accesibility most affected from healtchare facilities based on betweenness centrality</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Eisenberg</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>hospitals_betweenness_pre <span class="ot">&lt;-</span> <span class="fu">st_read</span>(eisenberg_connection, <span class="st">"centrality_424_hospitals_porto_end_id_centrality"</span>) </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>hospitals_betweenness_post <span class="ot">&lt;-</span> <span class="fu">st_read</span>(eisenberg_connection,<span class="st">"centrality_424_hospitals_porto_end_id_centrality_post"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="do">### Locally</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>hospitals_betweenness_pre_local <span class="ot">&lt;-</span> <span class="fu">st_read</span>(eisenberg_connection, <span class="fu">Id</span>(<span class="at">schema=</span><span class="st">"heigit"</span>, <span class="at">table =</span> <span class="st">"centrality_424_hospitals_porto_end_id_centrality_group"</span>))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>hospitals_betweenness_post_local <span class="ot">&lt;-</span> <span class="fu">st_read</span>(eisenberg_connection, <span class="fu">Id</span>(<span class="at">schema=</span><span class="st">"heigit"</span>, <span class="at">table =</span> <span class="st">"centrality_424_hospitals_porto_end_id_centrality_post_group"</span>))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>hospitals_betweenness_pre_local<span class="sc">$</span>event <span class="ot">&lt;-</span> <span class="st">"pre-event"</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>hospitals_betweenness_post_local<span class="sc">$</span>event <span class="ot">&lt;-</span> <span class="st">"post-event"</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Import</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>hospitals_betweenness_both_long <span class="ot">&lt;-</span> hospitals_betweenness_pre_local <span class="sc">|&gt;</span> <span class="fu">bind_rows</span>(hospitals_betweenness_post_local) <span class="sc">|&gt;</span> <span class="fu">subset</span>(<span class="at">select=</span><span class="fu">c</span>(<span class="st">"cd_cnes"</span>,<span class="st">"ds_cnes"</span>,<span class="st">"max_centrality"</span>,<span class="st">"event"</span>)) <span class="sc">|&gt;</span> <span class="fu">pivot_wider</span>(</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> event,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> max_centrality</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span>  <span class="fu">rename</span>( <span class="at">betwenness_pre=</span> <span class="st">`</span><span class="at">pre-event</span><span class="st">`</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">betwenness_post=</span> <span class="st">`</span><span class="at">post-event</span><span class="st">`</span>) </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>hospitals_betweenness_both_long[<span class="fu">is.na</span>(hospitals_betweenness_both_long)] <span class="ot">&lt;-</span> <span class="dv">0</span>    </span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="do">## pivot</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>hospitals_betweenness_long <span class="ot">&lt;-</span> hospitals_betweenness_both_long <span class="sc">|&gt;</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">mutate</span>(<span class="at">diff_betweenness_percent =</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>                                           (betwenness_post<span class="sc">-</span>betwenness_pre)<span class="sc">/</span>(betwenness_pre)<span class="sc">*</span><span class="dv">100</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">diff =</span> betwenness_post<span class="sc">-</span>betwenness_pre,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">letter =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">22</span>])  <span class="sc">|&gt;</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(letter) <span class="sc">|&gt;</span> </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>                             <span class="fu">pivot_longer</span>(</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>                                     <span class="fu">c</span>(betwenness_pre,betwenness_post),</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">names_to=</span><span class="st">"betweenness_type"</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">values_to=</span><span class="st">"betweenness_value"</span>) </span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>hospitals_betweenness_long_pre <span class="ot">&lt;-</span> </span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  hospitals_betweenness_long <span class="sc">|&gt;</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(betweenness_type <span class="sc">==</span> <span class="st">"betwenness_pre"</span>)</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>hospitals_betweenness_long_post <span class="ot">&lt;-</span> </span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>  hospitals_betweenness_long <span class="sc">|&gt;</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(betweenness_type <span class="sc">==</span> <span class="st">"betwenness_post"</span>)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>df_labels_betweenness <span class="ot">&lt;-</span> hospitals_betweenness_long <span class="sc">|&gt;</span> </span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(letter) <span class="sc">|&gt;</span> </span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">midpoint =</span> <span class="fu">mean</span>(betweenness_value), </span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">diff_betweenness_percent =</span> <span class="fu">first</span>(diff_betweenness_percent))</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a><span class="do">##</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(hospitals_betweenness_long, <span class="fu">aes</span>(<span class="at">x=</span>betweenness_value, <span class="at">y=</span><span class="fu">reorder</span>(letter, <span class="fu">desc</span>(diff_betweenness_percent)))) <span class="sc">+</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data=</span>hospitals_betweenness_long_pre,</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">x=</span>betweenness_value, <span class="at">y =</span> letter,</span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>                   <span class="at">yend=</span>hospitals_betweenness_long_post<span class="sc">$</span>letter, <span class="at">xend=</span>hospitals_betweenness_long_post<span class="sc">$</span>betweenness_value)) <span class="sc">+</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>betweenness_value, <span class="at">y =</span> letter, <span class="at">color =</span> betweenness_type, <span class="at">size=</span><span class="fl">2.5</span>))  <span class="sc">+</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> df_labels_betweenness, <span class="fu">aes</span>(<span class="at">x =</span> midpoint, <span class="at">y =</span> letter, <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(diff_betweenness_percent,<span class="dv">2</span>), <span class="st">" %"</span>)), </span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>            <span class="at">vjust =</span> <span class="fl">1.5</span>, <span class="at">size =</span> <span class="fl">3.5</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> betweenness_value, <span class="at">color =</span> betweenness_type), <span class="at">vjust =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">size=</span><span class="fl">3.5</span>) <span class="sc">+</span>  <span class="co"># Label the points with centrality_value</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Set1"</span>, <span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">expand=</span><span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.05</span>)) <span class="sc">+</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Centrality analysis"</span>,</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle=</span> <span class="st">"Change of centrality based on sum edge betweenness in hospitals"</span>,</span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">" Hospitals"</span>,</span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sum Edge Betweenness"</span>) <span class="sc">+</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title=</span><span class="fu">element_text</span>(<span class="at">family =</span><span class="st">"bold"</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"#626262"</span>, <span class="at">hjust=</span><span class="fl">0.5</span>),</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">'bottom'</span>) </span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a><span class="do">### table</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>df_hospitals_betweenness_both_compare <span class="ot">&lt;-</span> hospitals_betweenness_both_long <span class="sc">|&gt;</span> </span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">mutate</span>(<span class="at">diff_betweenness_percent =</span> </span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">round</span>((betwenness_post<span class="sc">-</span>betwenness_pre)<span class="sc">/</span>(betwenness_pre)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>),</span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">diff =</span> betwenness_post<span class="sc">-</span>betwenness_pre,</span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">letter =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">22</span>],</span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">ds_cnes =</span> stringr<span class="sc">::</span><span class="fu">str_to_title</span>(ds_cnes))</span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>                                                  </span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="fu">subset</span>(df_hospitals_betweenness_both_compare,</span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>                     <span class="at">select=</span><span class="fu">c</span>(<span class="st">"letter"</span>,<span class="st">"cd_cnes"</span>,<span class="st">"ds_cnes"</span>,<span class="st">"betwenness_pre"</span>,<span class="st">"betwenness_post"</span>,<span class="st">"diff_betweenness_percent"</span>)),</span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>              <span class="at">colnames=</span><span class="fu">c</span>(<span class="st">"ID"</span>,<span class="st">"Code"</span>,<span class="st">"Name"</span>,<span class="st">"Betweenness Pre"</span>,<span class="st">"Betweenness Post"</span>,<span class="st">"Diff(%)"</span>),</span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>              <span class="at">filter=</span><span class="st">"top"</span>,</span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a>              <span class="at">extensions=</span><span class="st">"Buttons"</span>,</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>                         <span class="at">options=</span><span class="fu">list</span>(</span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dom=</span><span class="st">"Bfrtip"</span>,</span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>                           <span class="at">buttons=</span><span class="fu">c</span>(<span class="st">"copy"</span>,<span class="st">"csv"</span>,<span class="st">"pdf"</span>),</span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>                            <span class="at">initComplete =</span> <span class="fu">JS</span>(</span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>    <span class="st">"function(settings, json) {"</span>,</span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$(this.api().table().header()).css({'background-color': '#d50038', 'color': '#fff'});"</span>,</span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a>    <span class="st">"}"</span>)</span>
<span id="cb7-83"><a href="#cb7-83" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb7-84"><a href="#cb7-84" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">|&gt;</span> </span>
<span id="cb7-85"><a href="#cb7-85" aria-hidden="true" tabindex="-1"></a>    DT<span class="sc">::</span><span class="fu">formatStyle</span>(<span class="st">"betwenness_pre"</span>,</span>
<span id="cb7-86"><a href="#cb7-86" aria-hidden="true" tabindex="-1"></a>              <span class="at">background=</span>DT<span class="sc">::</span><span class="fu">styleColorBar</span>(<span class="fu">range</span>(df_hospitals_betweenness_both_compare<span class="sc">$</span>betwenness_pre),<span class="st">'#ee8b8b'</span>),</span>
<span id="cb7-87"><a href="#cb7-87" aria-hidden="true" tabindex="-1"></a>                <span class="at">backgroundSize =</span> <span class="st">'98% 88%'</span>,</span>
<span id="cb7-88"><a href="#cb7-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">backgroundRepeat =</span> <span class="st">'no-repeat'</span>,</span>
<span id="cb7-89"><a href="#cb7-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">backgroundPosition =</span> <span class="st">'center'</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-90"><a href="#cb7-90" aria-hidden="true" tabindex="-1"></a>    DT<span class="sc">::</span><span class="fu">formatStyle</span>(<span class="st">"betwenness_post"</span>,</span>
<span id="cb7-91"><a href="#cb7-91" aria-hidden="true" tabindex="-1"></a>              <span class="at">background=</span>DT<span class="sc">::</span><span class="fu">styleColorBar</span>(<span class="fu">range</span>(df_hospitals_betweenness_both_compare<span class="sc">$</span>betwenness_pre),<span class="st">'#8ba1b3'</span>),</span>
<span id="cb7-92"><a href="#cb7-92" aria-hidden="true" tabindex="-1"></a>                <span class="at">backgroundSize =</span> <span class="st">'98% 88%'</span>,</span>
<span id="cb7-93"><a href="#cb7-93" aria-hidden="true" tabindex="-1"></a>  <span class="at">backgroundRepeat =</span> <span class="st">'no-repeat'</span>,</span>
<span id="cb7-94"><a href="#cb7-94" aria-hidden="true" tabindex="-1"></a>  <span class="at">backgroundPosition =</span> <span class="st">'center'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="./media/accessibility_test2.png" class="img-fluid"></p>
</section>
<section id="closeness" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="closeness"><span class="header-section-number">3.3.2</span> Closeness:</h3>
<div class="cell">
<details>
<summary>R: Changes on the accesibiliy based on closeness</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>hospitals_closeness_both <span class="ot">&lt;-</span> <span class="fu">st_read</span>(eisenberg_connection, <span class="st">"hospitals_closeness_both"</span>) </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df_hospitals_closeness_both_compare <span class="ot">&lt;-</span> hospitals_closeness_both <span class="sc">|&gt;</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">mutate</span>(<span class="at">diff_closeness_percent =</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                                                          <span class="fu">round</span>((closeness_post<span class="sc">-</span>closeness_pre)<span class="sc">/</span>(closeness_pre)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">diff =</span> closeness_post<span class="sc">-</span>closeness_pre,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">letter =</span> LETTERS[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>],</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                                                      <span class="at">ds_cnes =</span> stringr<span class="sc">::</span><span class="fu">str_to_title</span>(ds_cnes)) <span class="sc">|&gt;</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                                                  sf<span class="sc">::</span><span class="fu">st_drop_geometry</span>() </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                                                  </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(<span class="fu">subset</span>(df_hospitals_closeness_both_compare,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                     <span class="at">select=</span><span class="fu">c</span>(<span class="st">"letter"</span>,<span class="st">"cd_cnes"</span>,<span class="st">"ds_cnes"</span>,<span class="st">"closeness_pre"</span>,<span class="st">"closeness_post"</span>,<span class="st">"diff_closeness_percent"</span>)),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">colnames=</span><span class="fu">c</span>(<span class="st">"ID"</span>,<span class="st">"Code"</span>,<span class="st">"Name"</span>,<span class="st">"Closeness Pre"</span>,<span class="st">"Closeness Post"</span>,<span class="st">"Diff(%)"</span>),</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">filter=</span><span class="st">"top"</span>,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">extensions=</span><span class="st">"Buttons"</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">options=</span><span class="fu">list</span>(</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                           <span class="at">dom=</span><span class="st">"Bfrtip"</span>,</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                           <span class="at">buttons=</span><span class="fu">c</span>(<span class="st">"copy"</span>,<span class="st">"csv"</span>,<span class="st">"pdf"</span>),</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">initComplete =</span> <span class="fu">JS</span>(</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">"function(settings, json) {"</span>,</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">"$(this.api().table().header()).css({'background-color': '#d50038', 'color': '#fff'});"</span>,</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">"}"</span>)</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>                                  )</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">|&gt;</span> </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    DT<span class="sc">::</span><span class="fu">formatStyle</span>(<span class="st">"closeness_pre"</span>,</span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>              <span class="at">background=</span>DT<span class="sc">::</span><span class="fu">styleColorBar</span>(<span class="fu">range</span>(df_hospitals_closeness_both_compare<span class="sc">$</span>closeness_pre),<span class="st">'#ee8b8b'</span>),</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">backgroundSize =</span> <span class="st">'98% 88%'</span>,</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">backgroundRepeat =</span> <span class="st">'no-repeat'</span>,</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">backgroundPosition =</span> <span class="st">'center'</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>    DT<span class="sc">::</span><span class="fu">formatStyle</span>(<span class="st">"closeness_post"</span>,</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>              <span class="at">background=</span>DT<span class="sc">::</span><span class="fu">styleColorBar</span>(<span class="fu">range</span>(df_hospitals_closeness_both_compare<span class="sc">$</span>closeness_pre),<span class="st">'#8ba1b3'</span>),</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">backgroundSize =</span> <span class="st">'98% 88%'</span>,</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">backgroundRepeat =</span> <span class="st">'no-repeat'</span>,</span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">backgroundPosition =</span> <span class="st">'center'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-ec779fd1d4ba2e5d560c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ec779fd1d4ba2e5d560c">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2232030\" data-max=\"7092571\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"20232\" data-max=\"44432\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"27498\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"-100\" data-max=\"-37.19\" data-scale=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","extensions":["Buttons"],"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T"],[2232030,2232049,2232162,2237156,2237253,2237571,2237598,2237601,2262568,2265052,2265060,2778718,3006522,3007847,3508528,3567664,3626245,5026253,5223962,7092571],["Hospital Sao Camiloesteio","Hospital Dom Joao Becker","Hospital Municipal Getulio Vargassapucaia Do Sul","Hbmpa","Irmandade Da Santa Casa De Misericordia De Porto Alegre","Hospital Nossa Senhora Da Conceicao Sa","Hospital Divina Providencia","Hospital De Clinicas","Hospital Sao Lucas Da Pucrs","Hospital Femina Sa","Hospital Cristo Redentor Sa","Hps Porto Alegre","Hospital Moinhos De Vento","Hospital Mae De Deus","Hospital Universitario Ulbra","Hospital Ernesto Dornelles","Hospital Pronto Socorro De Canoas Dep Nelson Marchezan","Hospital Porto Alegre","Instituto De Cardiologia Hospital Viamao","Hospital Independencia"],[44432,37981,42543,33157,22054,26301,28389,20727,23488,21010,26550,20232,22118,25359,36716,20444,35663,21012,43779,26059],[2998,4712,3676,19324,13658,15471,14780,11808,12103,12254,16099,11464,13616,0,3460,11246,0,0,27498,13394],[-93.25,-87.59,-91.36,-41.72,-38.07,-41.18,-47.94,-43.03,-48.47,-41.68,-39.36,-43.34,-38.44,-100,-90.58,-44.99,-100,-100,-37.19,-48.6]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ID<\/th>\n      <th>Code<\/th>\n      <th>Name<\/th>\n      <th>Closeness Pre<\/th>\n      <th>Closeness Post<\/th>\n      <th>Diff(%)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"Bfrtip","buttons":["copy","csv","pdf"],"initComplete":"function(settings, json) {\n$(this.api().table().header()).css({'background-color': '#d50038', 'color': '#fff'});\n}","columnDefs":[{"className":"dt-right","targets":[2,4,5,6]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"letter","targets":1},{"name":"cd_cnes","targets":2},{"name":"ds_cnes","targets":3},{"name":"closeness_pre","targets":4},{"name":"closeness_post","targets":5},{"name":"diff_closeness_percent","targets":6}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"rowCallback":"function(row, data, displayNum, displayIndex, dataIndex) {\nvar value=data[4]; $(this.api().cell(row, 4).node()).css({'background':isNaN(parseFloat(value)) || value <= 20232.000000 ? '' : 'linear-gradient(90.000000deg, transparent ' + Math.max(44432.000000 - value, 0)/24200.000000 * 100 + '%, #ee8b8b ' + Math.max(44432.000000 - value, 0)/24200.000000 * 100 + '%)','background-size':'98% 88%','background-repeat':'no-repeat','background-position':'center'});\nvar value=data[5]; $(this.api().cell(row, 5).node()).css({'background':isNaN(parseFloat(value)) || value <= 20232.000000 ? '' : 'linear-gradient(90.000000deg, transparent ' + Math.max(44432.000000 - value, 0)/24200.000000 * 100 + '%, #8ba1b3 ' + Math.max(44432.000000 - value, 0)/24200.000000 * 100 + '%)','background-size':'98% 88%','background-repeat':'no-repeat','background-position':'center'});\n}"}},"evals":["options.initComplete","options.rowCallback"],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details>
<summary>R: Visualizing closeness of the healthcare facilities</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import he data</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="do">## hospital with closenesss values</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>closseness <span class="ot">&lt;-</span>sf<span class="sc">::</span><span class="fu">st_read</span>(eisenberg_connection, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                            <span class="at">layer =</span> <span class="st">"clossness_hospital_porto"</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>closseness_df <span class="ot">&lt;-</span> closseness <span class="sc">|&gt;</span>  <span class="fu">arrange</span>(ds_cnes, closeness) <span class="sc">|&gt;</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">mutate</span>(<span class="at">lng=</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">unlist</span>(<span class="fu">map</span>(geom_hospital,<span class="dv">1</span>)),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">lat=</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                              <span class="fu">unlist</span>(<span class="fu">map</span>(geom_hospital,<span class="dv">2</span>)),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">closeness_norm =</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                          (closseness<span class="sc">$</span>closeness <span class="sc">-</span> <span class="fu">min</span>(closseness<span class="sc">$</span>closeness)) <span class="sc">/</span> (<span class="fu">max</span>(closseness<span class="sc">$</span>closeness) <span class="sc">-</span> <span class="fu">min</span>(closseness<span class="sc">$</span>closeness)) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">position =</span> <span class="fu">rank</span>(<span class="sc">-</span>closeness))</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Create Color palette for visualization</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">colorQuantile</span>(<span class="at">palette =</span> <span class="st">"OrRd"</span>,closseness_df<span class="sc">$</span>closeness, <span class="at">n=</span><span class="dv">4</span> )</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="do">## Create leaflet product</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>icons <span class="ot">&lt;-</span> <span class="fu">makeAwesomeIcon</span>(</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">icon =</span> <span class="st">'fa-heartbeat'</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">iconColor =</span> <span class="st">"#FFFFFF"</span>,</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">markerColor =</span> <span class="st">"#57142c"</span>,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">library =</span> <span class="st">"fa"</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="fu">leaflet</span>(closseness_df) <span class="sc">|&gt;</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">addProviderTiles</span>(providers<span class="sc">$</span>OpenStreetMap.HOT) <span class="sc">|&gt;</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">addCircles</span>(<span class="at">data =</span>closseness_df , <span class="at">radius =</span> <span class="sc">~</span><span class="fu">sqrt</span>(closeness)<span class="sc">*</span><span class="dv">10</span>, <span class="at">fillOpacity =</span> .<span class="dv">50</span>, <span class="at">color =</span><span class="sc">~</span><span class="fu">pal</span>(closeness)) <span class="sc">|&gt;</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">addAwesomeMarkers</span>(<span class="at">data=</span>closseness_df,</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>                          <span class="at">icon =</span>icons,</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>                          <span class="at">popup=</span> <span class="sc">~</span><span class="fu">paste0</span>(<span class="st">"&lt;b&gt;Código CNES: &lt;/b&gt;"</span>, cd_cnes, <span class="st">"&lt;br/&gt;"</span>,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"&lt;b&gt;Nome: &lt;/b&gt;"</span>, ds_cnes, <span class="st">"&lt;br/&gt;"</span>,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"&lt;b&gt; Closeness&lt;/b&gt;:"</span>, closeness, <span class="st">"&lt;br/&gt;"</span>,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"&lt;b&gt;Longitude: &lt;/b&gt;"</span>, lng, <span class="st">"&lt;br/&gt;"</span>,</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>                                   <span class="st">"&lt;b&gt;Posição &lt;/b&gt;"</span>, position, <span class="st">"&lt;br/&gt;"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="leaflet html-widget html-fill-item" id="htmlwidget-9e691c045d39aab9b37c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9e691c045d39aab9b37c">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["OpenStreetMap.HOT",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addCircles","args":[[-30.09757,-30.009986,-30.039221,-30.084683,-29.940535,-30.047191,-30.028825,-30.061433,-30.059575,-30.026562,-29.822993,-30.016762,-30.044897,-29.906482,-29.839313,-30.056013,-29.88663,-30.037009,-30.081734,-30.030225],[-51.251219,-51.15921,-51.20721,-51.188157,-50.994548,-51.211842,-51.206359,-51.149065,-51.229305,-51.208747,-51.165688,-51.159139,-51.217128,-51.198458,-51.161951,-51.172921,-51.165818,-51.209228,-51.02973,-51.222786],[1820.906367719109,1629.417073680032,1439.687466084219,1684.903558070906,1948.871468311854,1429.82516413721,1449.482666333061,1614.280025274425,1592.45094115957,1487.212157024007,2062.595452336691,1621.758305050417,1449.551654822966,1888.464985113571,2107.889940200864,1532.579524853441,1916.141957162882,1422.392350935564,2092.343184088117,1485.05892138999],null,null,{"interactive":true,"className":"","stroke":true,"color":["#FC8D59","#FC8D59","#FEF0D9","#FC8D59","#D7301F","#FEF0D9","#FEF0D9","#FDCC8A","#FDCC8A","#FDCC8A","#D7301F","#FC8D59","#FEF0D9","#FC8D59","#D7301F","#FDCC8A","#D7301F","#FEF0D9","#D7301F","#FDCC8A"],"weight":5,"opacity":0.5,"fill":true,"fillColor":["#FC8D59","#FC8D59","#FEF0D9","#FC8D59","#D7301F","#FEF0D9","#FEF0D9","#FDCC8A","#FDCC8A","#FDCC8A","#D7301F","#FC8D59","#FEF0D9","#FC8D59","#D7301F","#FDCC8A","#D7301F","#FEF0D9","#D7301F","#FDCC8A"],"fillOpacity":0.5},null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null,null]},{"method":"addAwesomeMarkers","args":[[-30.09757,-30.009986,-30.039221,-30.084683,-29.940535,-30.047191,-30.028825,-30.061433,-30.059575,-30.026562,-29.822993,-30.016762,-30.044897,-29.906482,-29.839313,-30.056013,-29.88663,-30.037009,-30.081734,-30.030225],[-51.251219,-51.15921,-51.20721,-51.188157,-50.994548,-51.211842,-51.206359,-51.149065,-51.229305,-51.208747,-51.165688,-51.159139,-51.217128,-51.198458,-51.161951,-51.172921,-51.165818,-51.209228,-51.02973,-51.222786],{"icon":"fa-heartbeat","markerColor":"#57142c","iconColor":"#FFFFFF","spin":false,"squareMarker":false,"iconRotate":0,"font":"monospace","prefix":"fa"},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["<b>Código CNES: <\/b>2237156<br/><b>Nome: <\/b>HBMPA<br/><b> Closeness<\/b>:33157<br/><b>Longitude: <\/b>-51.251136<br/><b>Posição <\/b>7<br/>","<b>Código CNES: <\/b>2265060<br/><b>Nome: <\/b>HOSPITAL CRISTO REDENTOR SA<br/><b> Closeness<\/b>:26550<br/><b>Longitude: <\/b>-51.159402<br/><b>Posição <\/b>9<br/>","<b>Código CNES: <\/b>2237601<br/><b>Nome: <\/b>HOSPITAL DE CLINICAS<br/><b> Closeness<\/b>:20727<br/><b>Longitude: <\/b>-51.206436<br/><b>Posição <\/b>18<br/>","<b>Código CNES: <\/b>2237598<br/><b>Nome: <\/b>HOSPITAL DIVINA PROVIDENCIA<br/><b> Closeness<\/b>:28389<br/><b>Longitude: <\/b>-51.18811<br/><b>Posição <\/b>8<br/>","<b>Código CNES: <\/b>2232049<br/><b>Nome: <\/b>HOSPITAL DOM JOAO BECKER<br/><b> Closeness<\/b>:37981<br/><b>Longitude: <\/b>-50.994036<br/><b>Posição <\/b>4<br/>","<b>Código CNES: <\/b>3567664<br/><b>Nome: <\/b>HOSPITAL ERNESTO DORNELLES<br/><b> Closeness<\/b>:20444<br/><b>Longitude: <\/b>-51.211891<br/><b>Posição <\/b>19<br/>","<b>Código CNES: <\/b>2265052<br/><b>Nome: <\/b>HOSPITAL FEMINA SA<br/><b> Closeness<\/b>:21010<br/><b>Longitude: <\/b>-51.206837<br/><b>Posição <\/b>17<br/>","<b>Código CNES: <\/b>7092571<br/><b>Nome: <\/b>HOSPITAL INDEPENDENCIA<br/><b> Closeness<\/b>:26059<br/><b>Longitude: <\/b>-51.149056<br/><b>Posição <\/b>11<br/>","<b>Código CNES: <\/b>3007847<br/><b>Nome: <\/b>HOSPITAL MAE DE DEUS<br/><b> Closeness<\/b>:25359<br/><b>Longitude: <\/b>-51.229103<br/><b>Posição <\/b>12<br/>","<b>Código CNES: <\/b>3006522<br/><b>Nome: <\/b>HOSPITAL MOINHOS DE VENTO<br/><b> Closeness<\/b>:22118<br/><b>Longitude: <\/b>-51.209105<br/><b>Posição <\/b>14<br/>","<b>Código CNES: <\/b>2232162<br/><b>Nome: <\/b>HOSPITAL MUNICIPAL GETULIO VARGASSAPUCAIA DO SUL<br/><b> Closeness<\/b>:42543<br/><b>Longitude: <\/b>-51.165855<br/><b>Posição <\/b>3<br/>","<b>Código CNES: <\/b>2237571<br/><b>Nome: <\/b>HOSPITAL NOSSA SENHORA DA CONCEICAO SA<br/><b> Closeness<\/b>:26301<br/><b>Longitude: <\/b>-51.159043<br/><b>Posição <\/b>10<br/>","<b>Código CNES: <\/b>5026253<br/><b>Nome: <\/b>HOSPITAL PORTO ALEGRE<br/><b> Closeness<\/b>:21012<br/><b>Longitude: <\/b>-51.216909<br/><b>Posição <\/b>16<br/>","<b>Código CNES: <\/b>3626245<br/><b>Nome: <\/b>HOSPITAL PRONTO SOCORRO DE CANOAS DEP NELSON MARCHEZAN<br/><b> Closeness<\/b>:35663<br/><b>Longitude: <\/b>-51.198125<br/><b>Posição <\/b>6<br/>","<b>Código CNES: <\/b>2232030<br/><b>Nome: <\/b>HOSPITAL SAO CAMILOESTEIO<br/><b> Closeness<\/b>:44432<br/><b>Longitude: <\/b>-51.161425<br/><b>Posição <\/b>1<br/>","<b>Código CNES: <\/b>2262568<br/><b>Nome: <\/b>HOSPITAL SAO LUCAS DA PUCRS<br/><b> Closeness<\/b>:23488<br/><b>Longitude: <\/b>-51.173383<br/><b>Posição <\/b>13<br/>","<b>Código CNES: <\/b>3508528<br/><b>Nome: <\/b>HOSPITAL UNIVERSITARIO ULBRA<br/><b> Closeness<\/b>:36716<br/><b>Longitude: <\/b>-51.166042379<br/><b>Posição <\/b>5<br/>","<b>Código CNES: <\/b>2778718<br/><b>Nome: <\/b>HPS PORTO ALEGRE<br/><b> Closeness<\/b>:20232<br/><b>Longitude: <\/b>-51.209252<br/><b>Posição <\/b>20<br/>","<b>Código CNES: <\/b>5223962<br/><b>Nome: <\/b>INSTITUTO DE CARDIOLOGIA HOSPITAL VIAMAO<br/><b> Closeness<\/b>:43779<br/><b>Longitude: <\/b>-51.030015<br/><b>Posição <\/b>2<br/>","<b>Código CNES: <\/b>2237253<br/><b>Nome: <\/b>IRMANDADE DA SANTA CASA DE MISERICORDIA DE PORTO ALEGRE<br/><b> Closeness<\/b>:22054<br/><b>Longitude: <\/b>-51.222617<br/><b>Posição <\/b>15<br/>"],null,null,null,null,{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[-30.09757,-29.822993],"lng":[-51.251219,-50.994548]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="rq3-critical-infrastructures" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="rq3-critical-infrastructures"><span class="header-section-number">3.4</span> RQ3: Critical infrastructures</h2>
<blockquote class="blockquote">
<p>Where are the most critical infrastructures located for accessing health facilities to reinforce urban resilience against flooding?</p>
</blockquote>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-european_commission_joint_research_centre_ghsl_2023" class="csl-entry" role="listitem">
European Commission. Joint Research Centre. 2023. <em><span>GHSL</span> Data Package 2023.</em> <span>LU</span>: Publications Office. <a href="https://data.europa.eu/doi/10.2760/098587">https://data.europa.eu/doi/10.2760/098587</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./methodology.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Methodology</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./conclussion.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Conclussion</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>